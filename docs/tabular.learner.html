---

title: Tabular learner


keywords: fastai
sidebar: home_sidebar

summary: "The function to immediately get a `Learner` ready to train for tabular data"
description: "The function to immediately get a `Learner` ready to train for tabular data"
nb_path: "nbs/43_tabular.learner.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/43_tabular.learner.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The main function you probably want to use in this module is <a href="/tabular.learner.html#tabular_learner"><code>tabular_learner</code></a>. It will automatically create a <a href="/tabular.model.html#TabularModel"><code>TabularModel</code></a> suitable for your data and infer the right loss function. See the <a href="http://docs.fast.ai/tutorial.tabular">tabular tutorial</a> for an example of use in context.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Main-functions">Main functions<a class="anchor-link" href="#Main-functions"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="TabularLearner" class="doc_header"><code>class</code> <code>TabularLearner</code><a href="https://github.com/fastai/fastai/tree/master/fastai/tabular/learner.py#L17" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>TabularLearner</code>(<strong><code>dls</code></strong>, <strong><code>model</code></strong>, <strong><code>loss_func</code></strong>=<em><code>None</code></em>, <strong><code>opt_func</code></strong>=<em><code>Adam</code></em>, <strong><code>lr</code></strong>=<em><code>0.001</code></em>, <strong><code>splitter</code></strong>=<em><code>trainable_params</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>metrics</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>model_dir</code></strong>=<em><code>'models'</code></em>, <strong><code>wd</code></strong>=<em><code>None</code></em>, <strong><code>wd_bn_bias</code></strong>=<em><code>False</code></em>, <strong><code>train_bn</code></strong>=<em><code>True</code></em>, <strong><code>moms</code></strong>=<em><code>(0.95, 0.85, 0.95)</code></em>) :: <a href="/learner.html#Learner"><code>Learner</code></a></p>
</blockquote>
<p><a href="/learner.html#Learner"><code>Learner</code></a> for tabular data</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It works exactly as a normal <a href="/learner.html#Learner"><code>Learner</code></a>, the only difference is that it implements a <code>predict</code> method specific to work on a row of data.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="tabular_learner" class="doc_header"><code>tabular_learner</code><a href="https://github.com/fastai/fastai/tree/master/fastai/tabular/learner.py#L31" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>tabular_learner</code>(<strong><code>dls</code></strong>:<a href="/tabular.data.html#TabularDataLoaders"><code>TabularDataLoaders</code></a>, <strong><code>layers</code></strong>:<code>list</code>=<em><code>None</code></em>, <strong><code>emb_szs</code></strong>:<code>list</code>=<em><code>None</code></em>, <strong><code>config</code></strong>:<code>dict</code>=<em><code>None</code></em>, <strong><code>n_out</code></strong>:<code>int</code>=<em><code>None</code></em>, <strong><code>y_range</code></strong>:<code>(float, float)</code>=<em><code>None</code></em>, <strong><code>loss_func</code></strong>=<em><code>None</code></em>, <strong><code>opt_func</code></strong>=<em><code>Adam</code></em>, <strong><code>lr</code></strong>=<em><code>0.001</code></em>, <strong><code>splitter</code></strong>=<em><code>trainable_params</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>metrics</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>model_dir</code></strong>=<em><code>'models'</code></em>, <strong><code>wd</code></strong>=<em><code>None</code></em>, <strong><code>wd_bn_bias</code></strong>=<em><code>False</code></em>, <strong><code>train_bn</code></strong>=<em><code>True</code></em>, <strong><code>moms</code></strong>=<em><code>(0.95, 0.85, 0.95)</code></em>)</p>
</blockquote>
<p>Get a <a href="/learner.html#Learner"><code>Learner</code></a> using <code>dls</code>, with <code>metrics</code>, including a <a href="/tabular.model.html#TabularModel"><code>TabularModel</code></a> created using the remaining params.</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>layers</code></strong></td>
<td><code>list</code></td>
<td><code>None</code></td>
<td>Size of the layers generated by <a href="/layers.html#LinBnDrop"><code>LinBnDrop</code></a></td>
</tr>
<tr>
<td><strong><code>emb_szs</code></strong></td>
<td><code>list</code></td>
<td><code>None</code></td>
<td>Tuples of <code>n_unique, embedding_size</code> for all categorical features</td>
</tr>
<tr>
<td><strong><code>config</code></strong></td>
<td><code>dict</code></td>
<td><code>None</code></td>
<td>Config params for TabularModel from <a href="/tabular.model.html#tabular_config"><code>tabular_config</code></a></td>
</tr>
<tr>
<td><strong><code>n_out</code></strong></td>
<td><code>int</code></td>
<td><code>None</code></td>
<td>Final output size of the model</td>
</tr>
<tr>
<td><strong><code>y_range</code></strong></td>
<td><code>(float, float)</code></td>
<td><code>None</code></td>
<td>Low and high for the final sigmoid function</td>
</tr>
<tr>
<td></td>
<td></td>
<td><strong>Valid Keyword Arguments</strong></td>
<td></td>
</tr>
<tr>
<td><strong><code>dls</code></strong></td>
<td><a href="/tabular.data.html#TabularDataLoaders"><code>TabularDataLoaders</code></a></td>
<td></td>
<td>Argument passed to <a href="/learner.html#Learner.__init__"><code>Learner.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>loss_func</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/learner.html#Learner.__init__"><code>Learner.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>opt_func</code></strong></td>
<td><code>function</code></td>
<td><a href="/optimizer.html#Adam"><code>Adam</code></a></td>
<td>Argument passed to <a href="/learner.html#Learner.__init__"><code>Learner.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>lr</code></strong></td>
<td><code>float</code></td>
<td><code>0.001</code></td>
<td>Argument passed to <a href="/learner.html#Learner.__init__"><code>Learner.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>splitter</code></strong></td>
<td><code>function</code></td>
<td><a href="/torch_core.html#trainable_params"><code>trainable_params</code></a></td>
<td>Argument passed to <a href="/learner.html#Learner.__init__"><code>Learner.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>cbs</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/learner.html#Learner.__init__"><code>Learner.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>metrics</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/learner.html#Learner.__init__"><code>Learner.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>path</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/learner.html#Learner.__init__"><code>Learner.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>model_dir</code></strong></td>
<td><code>str</code></td>
<td><code>models</code></td>
<td>Argument passed to <a href="/learner.html#Learner.__init__"><code>Learner.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>wd</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/learner.html#Learner.__init__"><code>Learner.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>wd_bn_bias</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Argument passed to <a href="/learner.html#Learner.__init__"><code>Learner.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>train_bn</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Argument passed to <a href="/learner.html#Learner.__init__"><code>Learner.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>moms</code></strong></td>
<td><code>tuple</code></td>
<td><code>(0.95, 0.85, 0.95)</code></td>
<td>Argument passed to <a href="/learner.html#Learner.__init__"><code>Learner.__init__</code></a></td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If your data was built with fastai, you probably won't need to pass anything to <code>emb_szs</code> unless you want to change the default of the library (produced by <a href="/tabular.model.html#get_emb_sz"><code>get_emb_sz</code></a>), same for <code>n_out</code> which should be automatically inferred. <a href="/layers.html"><code>layers</code></a> will default to <code>[200,100]</code> and is passed to <a href="/tabular.model.html#TabularModel"><code>TabularModel</code></a> along with the <code>config</code>.</p>
<p>Use <a href="/tabular.model.html#tabular_config"><code>tabular_config</code></a> to create a <code>config</code> and customize the model used. There is just easy access to <code>y_range</code> because this argument is often used.</p>
<p>All the other arguments are passed to <a href="/learner.html#Learner"><code>Learner</code></a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">ADULT_SAMPLE</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;adult.csv&#39;</span><span class="p">)</span>
<span class="n">cat_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;workclass&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;marital-status&#39;</span><span class="p">,</span> <span class="s1">&#39;occupation&#39;</span><span class="p">,</span> <span class="s1">&#39;relationship&#39;</span><span class="p">,</span> <span class="s1">&#39;race&#39;</span><span class="p">]</span>
<span class="n">cont_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;fnlwgt&#39;</span><span class="p">,</span> <span class="s1">&#39;education-num&#39;</span><span class="p">]</span>
<span class="n">procs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Categorify</span><span class="p">,</span> <span class="n">FillMissing</span><span class="p">,</span> <span class="n">Normalize</span><span class="p">]</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">TabularDataLoaders</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">procs</span><span class="o">=</span><span class="n">procs</span><span class="p">,</span> <span class="n">cat_names</span><span class="o">=</span><span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="o">=</span><span class="n">cont_names</span><span class="p">,</span> 
                                 <span class="n">y_names</span><span class="o">=</span><span class="s2">&quot;salary&quot;</span><span class="p">,</span> <span class="n">valid_idx</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span><span class="mi">1000</span><span class="p">)),</span> <span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="TabularLearner.predict" class="doc_header"><code>TabularLearner.predict</code><a href="https://github.com/fastai/fastai/tree/master/fastai/tabular/learner.py#L19" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>TabularLearner.predict</code>(<strong><code>row</code></strong>:<code>pd.Series</code>)</p>
</blockquote>
<p>Predict on a single sample</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>row</code></strong></td>
<td><code>pd.Series</code></td>
<td></td>
<td>Features to be predicted</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can pass in an individual row of data into our <a href="/tabular.learner.html#TabularLearner"><code>TabularLearner</code></a>'s <code>predict</code> method. It's output is slightly different from the other <code>predict</code> methods, as this one will always return the input as well:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">row</span><span class="p">,</span> <span class="n">clas</span><span class="p">,</span> <span class="n">probs</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">row</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>workclass</th>
      <th>education</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>education-num_na</th>
      <th>age</th>
      <th>fnlwgt</th>
      <th>education-num</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Private</td>
      <td>Assoc-acdm</td>
      <td>Married-civ-spouse</td>
      <td>#na#</td>
      <td>Wife</td>
      <td>White</td>
      <td>False</td>
      <td>49.0</td>
      <td>101320.001685</td>
      <td>12.0</td>
      <td>&lt;50k</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clas</span><span class="p">,</span> <span class="n">probs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(0), tensor([0.5264, 0.4736]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

