---

title: basic_data
keywords: fastai
sidebar: home_sidebar

summary: "Basic classes to contain the data for model training."
---
<!--


#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: docs_src/basic_data.ipynb
# instructions: https://docs.fast.ai/gen_doc_main.html

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Get-your-data-ready-for-training">Get your data ready for training<a class="anchor-link" href="#Get-your-data-ready-for-training">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This module defines the basic <a href="/basic_data.html#DataBunch"><code>DataBunch</code></a> object that is used inside <a href="/basic_train.html#Learner"><code>Learner</code></a> to train a model. This is the generic class, that can take any kind of fastai <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset"><code>Dataset</code></a> or <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a>. You'll find helpful functions in the data module of every application to directly create this <a href="/basic_data.html#DataBunch"><code>DataBunch</code></a> for you.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="DataBunch" class="doc_header"><code>class</code> <code>DataBunch</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L84" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#DataBunch-pytest" style="float:right; padding-right:10px">[test]</a></h2><blockquote><p><code>DataBunch</code>(<strong><code>train_dl</code></strong>:<a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a>, <strong><code>valid_dl</code></strong>:<a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a>, <strong><code>fix_dl</code></strong>:<a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a>=<strong><em><code>None</code></em></strong>, <strong><code>test_dl</code></strong>:<code>Optional</code>[<a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a>]=<strong><em><code>None</code></em></strong>, <strong><code>device</code></strong>:<a href="https://pytorch.org/docs/stable/tensor_attributes.html#torch-device"><code>device</code></a>=<strong><em><code>None</code></em></strong>, <strong><code>dl_tfms</code></strong>:<code>Optional</code>[<code>Collection</code>[<code>Callable</code>]]=<strong><em><code>None</code></em></strong>, <strong><code>path</code></strong>:<code>PathOrStr</code>=<strong><em><code>'.'</code></em></strong>, <strong><code>collate_fn</code></strong>:<code>Callable</code>=<strong><em><code>'data_collate'</code></em></strong>, <strong><code>no_check</code></strong>:<code>bool</code>=<strong><em><code>False</code></em></strong>)</p>
</blockquote>
<div class="collapse" id="DataBunch-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DataBunch-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>Tests found for <code>DataBunch</code>:</p><ul><li><code>pytest -sv tests/test_data_block.py::test_custom_dataset</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_data_block.py#L152" class="source_link" style="float:right">[source]</a></li></ul><p>Some other tests where <code>DataBunch</code> is used:</p><ul><li><code>pytest -sv tests/test_basic_data.py::test_DataBunch_Create</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_basic_data.py#L30" class="source_link" style="float:right">[source]</a></li><li><code>pytest -sv tests/test_basic_data.py::test_DataBunch_no_valid_dl</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_basic_data.py#L45" class="source_link" style="float:right">[source]</a></li><li><code>pytest -sv tests/test_basic_data.py::test_DataBunch_save_load</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_basic_data.py#L85" class="source_link" style="float:right">[source]</a></li></ul><p>To run tests please refer to this <a href="/dev/test.html#quick-guide">guide</a>.</p></div></div><p>Bind <code>train_dl</code>,<code>valid_dl</code> and <code>test_dl</code> in a data object.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It also ensures all the dataloaders are on <code>device</code> and applies to them <code>dl_tfms</code> as batch are drawn (like normalization). <code>path</code> is used internally to store temporary files, <code>collate_fn</code> is passed to the pytorch <code>Dataloader</code> (replacing the one there) to explain how to collate the samples picked for a batch. By default, it applies data to the object sent (see in <a href="/vision.image.html#vision.image"><code>vision.image</code></a> or the <a href="/data_block.html">data block API</a> why this can be important).</p>
<p><code>train_dl</code>, <code>valid_dl</code> and optionally <code>test_dl</code> will be wrapped in <a href="/basic_data.html#DeviceDataLoader"><code>DeviceDataLoader</code></a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Factory-method">Factory method<a class="anchor-link" href="#Factory-method">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="DataBunch.create" class="doc_header"><code>create</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L111" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#DataBunch-create-pytest" style="float:right; padding-right:10px">[test]</a></h4><blockquote><p><code>create</code>(<strong><code>train_ds</code></strong>:<a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset"><code>Dataset</code></a>, <strong><code>valid_ds</code></strong>:<a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset"><code>Dataset</code></a>, <strong><code>test_ds</code></strong>:<code>Optional</code>[<a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset"><code>Dataset</code></a>]=<strong><em><code>None</code></em></strong>, <strong><code>path</code></strong>:<code>PathOrStr</code>=<strong><em><code>'.'</code></em></strong>, <strong><code>bs</code></strong>:<code>int</code>=<strong><em><code>64</code></em></strong>, <strong><code>val_bs</code></strong>:<code>int</code>=<strong><em><code>None</code></em></strong>, <strong><code>num_workers</code></strong>:<code>int</code>=<strong><em><code>16</code></em></strong>, <strong><code>dl_tfms</code></strong>:<code>Optional</code>[<code>Collection</code>[<code>Callable</code>]]=<strong><em><code>None</code></em></strong>, <strong><code>device</code></strong>:<a href="https://pytorch.org/docs/stable/tensor_attributes.html#torch-device"><code>device</code></a>=<strong><em><code>None</code></em></strong>, <strong><code>collate_fn</code></strong>:<code>Callable</code>=<strong><em><code>'data_collate'</code></em></strong>, <strong><code>no_check</code></strong>:<code>bool</code>=<strong><em><code>False</code></em></strong>, <strong>**<code>dl_kwargs</code></strong>) → <code>DataBunch</code></p>
</blockquote>
<div class="collapse" id="DataBunch-create-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DataBunch-create-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>Tests found for <code>create</code>:</p><ul><li><code>pytest -sv tests/test_basic_data.py::test_DataBunch_Create</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_basic_data.py#L30" class="source_link" style="float:right">[source]</a></li><li><code>pytest -sv tests/test_basic_data.py::test_DataBunch_no_valid_dl</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_basic_data.py#L45" class="source_link" style="float:right">[source]</a></li></ul><p>Some other tests where <code>create</code> is used:</p><ul><li><code>pytest -sv tests/test_basic_data.py::test_DeviceDataLoader_getitem</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_basic_data.py#L110" class="source_link" style="float:right">[source]</a></li></ul><p>To run tests please refer to this <a href="/dev/test.html#quick-guide">guide</a>.</p></div></div><p>Create a <a href="/basic_data.html#DataBunch"><code>DataBunch</code></a> from <code>train_ds</code>, <code>valid_ds</code> and maybe <code>test_ds</code> with a batch size of <code>bs</code>. Passes <code>**dl_kwargs</code> to <code>DataLoader()</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>num_workers</code> is the number of CPUs to use, <code>tfms</code>, <code>device</code> and <code>collate_fn</code> are passed to the init method.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<div markdown="span" class="alert alert-danger" role="alert"><i class="fa fa-danger-circle"></i> <b>Warning: </b>You can pass regular pytorch Dataset here, but they'll require more attributes than the basic ones to work with the library. See below for more details.</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Visualization">Visualization<a class="anchor-link" href="#Visualization">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="DataBunch.show_batch" class="doc_header"><code>show_batch</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L184" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#DataBunch-show_batch-pytest" style="float:right; padding-right:10px">[test]</a></h4><blockquote><p><code>show_batch</code>(<strong><code>rows</code></strong>:<code>int</code>=<strong><em><code>5</code></em></strong>, <strong><code>ds_type</code></strong>:<a href="/basic_data.html#DatasetType"><code>DatasetType</code></a>=<strong><em><code>&lt;DatasetType.Train: 1&gt;</code></em></strong>, <strong><code>reverse</code></strong>:<code>bool</code>=<strong><em><code>False</code></em></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<div class="collapse" id="DataBunch-show_batch-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DataBunch-show_batch-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>Tests found for <code>show_batch</code>:</p><ul><li><code>pytest -sv tests/test_basic_data.py::test_DataBunch_show_batch</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_basic_data.py#L77" class="source_link" style="float:right">[source]</a></li></ul><p>To run tests please refer to this <a href="/dev/test.html#quick-guide">guide</a>.</p></div></div><p>Show a batch of data in <code>ds_type</code> on a few <code>rows</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Grabbing-some-data">Grabbing some data<a class="anchor-link" href="#Grabbing-some-data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="DataBunch.dl" class="doc_header"><code>dl</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L125" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#DataBunch-dl-pytest" style="float:right; padding-right:10px">[test]</a></h4><blockquote><p><code>dl</code>(<strong><code>ds_type</code></strong>:<a href="/basic_data.html#DatasetType"><code>DatasetType</code></a>=<strong><em><code>&lt;DatasetType.Valid: 2&gt;</code></em></strong>) → <a href="/basic_data.html#DeviceDataLoader"><code>DeviceDataLoader</code></a></p>
</blockquote>
<div class="collapse" id="DataBunch-dl-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DataBunch-dl-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>No tests found for <code>dl</code>. To contribute a test please refer to <a href="/dev/test.html">this guide</a> and <a href="https://forums.fast.ai/t/improving-expanding-functional-tests/32929">this discussion</a>.</p></div></div><p>Returns an appropriate <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a> with a dataset for validation, training, or test (<code>ds_type</code>).</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="DataBunch.one_batch" class="doc_header"><code>one_batch</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L164" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#DataBunch-one_batch-pytest" style="float:right; padding-right:10px">[test]</a></h4><blockquote><p><code>one_batch</code>(<strong><code>ds_type</code></strong>:<a href="/basic_data.html#DatasetType"><code>DatasetType</code></a>=<strong><em><code>&lt;DatasetType.Train: 1&gt;</code></em></strong>, <strong><code>detach</code></strong>:<code>bool</code>=<strong><em><code>True</code></em></strong>, <strong><code>denorm</code></strong>:<code>bool</code>=<strong><em><code>True</code></em></strong>, <strong><code>cpu</code></strong>:<code>bool</code>=<strong><em><code>True</code></em></strong>) → <code>Collection</code>[<code>Tensor</code>]</p>
</blockquote>
<div class="collapse" id="DataBunch-one_batch-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DataBunch-one_batch-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>Tests found for <code>one_batch</code>:</p><ul><li><code>pytest -sv tests/test_basic_data.py::test_DataBunch_onebatch</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_basic_data.py#L60" class="source_link" style="float:right">[source]</a></li><li><code>pytest -sv tests/test_basic_data.py::test_DataBunch_save_load</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_basic_data.py#L85" class="source_link" style="float:right">[source]</a></li><li><code>pytest -sv tests/test_text_data.py::test_backwards_cls_databunch</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_text_data.py#L110" class="source_link" style="float:right">[source]</a></li><li><code>pytest -sv tests/test_text_data.py::test_should_load_backwards_lm_1</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_text_data.py#L83" class="source_link" style="float:right">[source]</a></li><li><code>pytest -sv tests/test_text_data.py::test_should_load_backwards_lm_2</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_text_data.py#L99" class="source_link" style="float:right">[source]</a></li></ul><p>To run tests please refer to this <a href="/dev/test.html#quick-guide">guide</a>.</p></div></div><p>Get one batch from the data loader of <code>ds_type</code>. Optionally <code>detach</code> and <code>denorm</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="DataBunch.one_item" class="doc_header"><code>one_item</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L178" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#DataBunch-one_item-pytest" style="float:right; padding-right:10px">[test]</a></h4><blockquote><p><code>one_item</code>(<strong><code>item</code></strong>, <strong><code>detach</code></strong>:<code>bool</code>=<strong><em><code>False</code></em></strong>, <strong><code>denorm</code></strong>:<code>bool</code>=<strong><em><code>False</code></em></strong>, <strong><code>cpu</code></strong>:<code>bool</code>=<strong><em><code>False</code></em></strong>)</p>
</blockquote>
<div class="collapse" id="DataBunch-one_item-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DataBunch-one_item-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>Tests found for <code>one_item</code>:</p><ul><li><code>pytest -sv tests/test_basic_data.py::test_DataBunch_oneitem</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_basic_data.py#L69" class="source_link" style="float:right">[source]</a></li></ul><p>To run tests please refer to this <a href="/dev/test.html#quick-guide">guide</a>.</p></div></div><p>Get <code>item</code> into a batch. Optionally <code>detach</code> and <code>denorm</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="DataBunch.sanity_check" class="doc_header"><code>sanity_check</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L242" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#DataBunch-sanity_check-pytest" style="float:right; padding-right:10px">[test]</a></h4><blockquote><p><code>sanity_check</code>()</p>
</blockquote>
<div class="collapse" id="DataBunch-sanity_check-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DataBunch-sanity_check-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>No tests found for <code>sanity_check</code>. To contribute a test please refer to <a href="/dev/test.html">this guide</a> and <a href="https://forums.fast.ai/t/improving-expanding-functional-tests/32929">this discussion</a>.</p></div></div><p>Check the underlying data in the training set can be properly loaded.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Load-and-save">Load and save<a class="anchor-link" href="#Load-and-save">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can save your <a href="/basic_data.html#DataBunch"><code>DataBunch</code></a> object for future use with this method.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="DataBunch.save" class="doc_header"><code>save</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L149" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#DataBunch-save-pytest" style="float:right; padding-right:10px">[test]</a></h4><blockquote><p><code>save</code>(<strong><code>file</code></strong>:<code>PathLikeOrBinaryStream</code>=<strong><em><code>'data_save.pkl'</code></em></strong>)</p>
</blockquote>
<div class="collapse" id="DataBunch-save-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DataBunch-save-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>Tests found for <code>save</code>:</p><ul><li><code>pytest -sv tests/test_basic_data.py::test_DataBunch_save_load</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_basic_data.py#L85" class="source_link" style="float:right">[source]</a></li></ul><p>To run tests please refer to this <a href="/dev/test.html#quick-guide">guide</a>.</p></div></div><p>Save the <a href="/basic_data.html#DataBunch"><code>DataBunch</code></a> in <code>self.path/file</code>. <code>file</code> can be file-like (file or buffer)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_data" class="doc_header"><code>load_data</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L275" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#load_data-pytest" style="float:right; padding-right:10px">[test]</a></h4><blockquote><p><code>load_data</code>(<strong><code>path</code></strong>:<code>PathOrStr</code>, <strong><code>file</code></strong>:<code>PathLikeOrBinaryStream</code>=<strong><em><code>'data_save.pkl'</code></em></strong>, <strong><code>bs</code></strong>:<code>int</code>=<strong><em><code>64</code></em></strong>, <strong><code>val_bs</code></strong>:<code>int</code>=<strong><em><code>None</code></em></strong>, <strong><code>num_workers</code></strong>:<code>int</code>=<strong><em><code>16</code></em></strong>, <strong><code>dl_tfms</code></strong>:<code>Optional</code>[<code>Collection</code>[<code>Callable</code>]]=<strong><em><code>None</code></em></strong>, <strong><code>device</code></strong>:<a href="https://pytorch.org/docs/stable/tensor_attributes.html#torch-device"><code>device</code></a>=<strong><em><code>None</code></em></strong>, <strong><code>collate_fn</code></strong>:<code>Callable</code>=<strong><em><code>'data_collate'</code></em></strong>, <strong><code>no_check</code></strong>:<code>bool</code>=<strong><em><code>False</code></em></strong>, <strong>**<code>kwargs</code></strong>) → <a href="/basic_data.html#DataBunch"><code>DataBunch</code></a></p>
</blockquote>
<div class="collapse" id="load_data-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#load_data-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>Tests found for <code>load_data</code>:</p><ul><li><code>pytest -sv tests/test_basic_data.py::test_DataBunch_save_load</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_basic_data.py#L85" class="source_link" style="float:right">[source]</a></li><li><code>pytest -sv tests/test_text_data.py::test_load_and_save_test</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_text_data.py#L129" class="source_link" style="float:right">[source]</a></li></ul><p>To run tests please refer to this <a href="/dev/test.html#quick-guide">guide</a>.</p></div></div><p>Load a saved <a href="/basic_data.html#DataBunch"><code>DataBunch</code></a> from <code>path/file</code>. <code>file</code> can be file-like (file or buffer)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<div markdown="span" class="alert alert-warning" role="alert"><i class="fa fa-warning-circle"></i> <b>Important: </b>The arguments you passed when you created your first `DataBunch` aren't saved, so you should pass them here if you don't want the default.</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<div markdown="span" class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Note: </b>Data cannot be serialized on Windows and then loaded on Linux or vice versa because `Path` object doesn't support this. We will find a workaround for that in v2.</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is to allow you to easily create a new <a href="/basic_data.html#DataBunch"><code>DataBunch</code></a> with a different batch size for instance. You will also need to reapply any normalization (in vision) you might have done on your original <a href="/basic_data.html#DataBunch"><code>DataBunch</code></a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Empty-DataBunch-for-inference">Empty <a href="/basic_data.html#DataBunch"><code>DataBunch</code></a> for inference<a class="anchor-link" href="#Empty-DataBunch-for-inference">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="DataBunch.export" class="doc_header"><code>export</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L197" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#DataBunch-export-pytest" style="float:right; padding-right:10px">[test]</a></h4><blockquote><p><code>export</code>(<strong><code>file</code></strong>:<code>PathLikeOrBinaryStream</code>=<strong><em><code>'export.pkl'</code></em></strong>)</p>
</blockquote>
<div class="collapse" id="DataBunch-export-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DataBunch-export-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>No tests found for <code>export</code>. To contribute a test please refer to <a href="/dev/test.html">this guide</a> and <a href="https://forums.fast.ai/t/improving-expanding-functional-tests/32929">this discussion</a>.</p></div></div><p>Export the minimal state of <code>self</code> for inference in <code>self.path/file</code>. <code>file</code> can be file-like (file or buffer)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="_databunch_load_empty" class="doc_header"><code>load_empty</code><a href="https://github.com/fastai/fastai/blob/master/fastai/data_block.py#L747" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#_databunch_load_empty-pytest" style="float:right; padding-right:10px">[test]</a></h4><blockquote><p><code>load_empty</code>(<strong><code>path</code></strong>, <strong><code>fname</code></strong>:<code>str</code>=<strong><em><code>'export.pkl'</code></em></strong>)</p>
</blockquote>
<div class="collapse" id="_databunch_load_empty-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#_databunch_load_empty-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>No tests found for <code>_databunch_load_empty</code>. To contribute a test please refer to <a href="/dev/test.html">this guide</a> and <a href="https://forums.fast.ai/t/improving-expanding-functional-tests/32929">this discussion</a>.</p></div></div><p>Load an empty <a href="/basic_data.html#DataBunch"><code>DataBunch</code></a> from the exported file in <code>path/fname</code> with optional <code>tfms</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This method should be used to create a <a href="/basic_data.html#DataBunch"><code>DataBunch</code></a> at inference, see the corresponding <a href="/tutorial.inference.html">tutorial</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="DataBunch.add_test" class="doc_header"><code>add_test</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L157" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#DataBunch-add_test-pytest" style="float:right; padding-right:10px">[test]</a></h4><blockquote><p><code>add_test</code>(<strong><code>items</code></strong>:<code>Iterator</code>[<code>T_co</code>], <strong><code>label</code></strong>:<code>Any</code>=<strong><em><code>None</code></em></strong>, <strong><code>tfms</code></strong>=<strong><em><code>None</code></em></strong>, <strong><code>tfm_y</code></strong>=<strong><em><code>None</code></em></strong>)</p>
</blockquote>
<div class="collapse" id="DataBunch-add_test-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DataBunch-add_test-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>No tests found for <code>add_test</code>. To contribute a test please refer to <a href="/dev/test.html">this guide</a> and <a href="https://forums.fast.ai/t/improving-expanding-functional-tests/32929">this discussion</a>.</p></div></div><p>Add the <code>items</code> as a test set. Pass along <code>label</code> otherwise label them with <a href="/core.html#EmptyLabel"><code>EmptyLabel</code></a>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Dataloader-transforms">Dataloader transforms<a class="anchor-link" href="#Dataloader-transforms">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="DataBunch.add_tfm" class="doc_header"><code>add_tfm</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L143" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#DataBunch-add_tfm-pytest" style="float:right; padding-right:10px">[test]</a></h4><blockquote><p><code>add_tfm</code>(<strong><code>tfm</code></strong>:<code>Callable</code>)</p>
</blockquote>
<div class="collapse" id="DataBunch-add_tfm-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DataBunch-add_tfm-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>No tests found for <code>add_tfm</code>. To contribute a test please refer to <a href="/dev/test.html">this guide</a> and <a href="https://forums.fast.ai/t/improving-expanding-functional-tests/32929">this discussion</a>.</p></div></div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Adds a transform to all dataloaders.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Using-a-custom-Dataset-in-fastai">Using a custom Dataset in fastai<a class="anchor-link" href="#Using-a-custom-Dataset-in-fastai">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you want to use your pytorch <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset"><code>Dataset</code></a> in fastai, you may need to implement more attributes/methods if you want to use the full functionality of the library. Some functions can easily be used with your pytorch <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset"><code>Dataset</code></a> if you just add an attribute, for others, the best would be to create your own <a href="/data_block.html#ItemList"><code>ItemList</code></a> by following <a href="/tutorial.itemlist.html">this tutorial</a>. Here is a full list of what the library will expect.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Basics">Basics<a class="anchor-link" href="#Basics">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First of all, you obviously need to implement the methods <code>__len__</code> and <code>__getitem__</code>, as indicated by the pytorch docs. Then the most needed things would be:</p>
<ul>
<li><code>c</code> attribute: it's used in most functions that directly create a <a href="/basic_train.html#Learner"><code>Learner</code></a> (<a href="/tabular.learner.html#tabular_learner"><code>tabular_learner</code></a>, <a href="/text.learner.html#text_classifier_learner"><code>text_classifier_learner</code></a>, <a href="/vision.learner.html#unet_learner"><code>unet_learner</code></a>, <a href="/vision.learner.html#cnn_learner"><code>cnn_learner</code></a>) and represents the number of outputs of the final layer of your model (also the number of classes if applicable).</li>
<li><code>classes</code> attribute: it's used by <a href="/train.html#ClassificationInterpretation"><code>ClassificationInterpretation</code></a> and also in <a href="/collab.html#collab_learner"><code>collab_learner</code></a> (best to use <a href="/collab.html#CollabDataBunch.from_df"><code>CollabDataBunch.from_df</code></a> than a pytorch <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset"><code>Dataset</code></a>) and represents the unique tags that appear in your data.</li>
<li>maybe a <code>loss_func</code> attribute: that is going to be used by <a href="/basic_train.html#Learner"><code>Learner</code></a> as a default loss function, so if you know your custom <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset"><code>Dataset</code></a> requires a particular loss, you can put it.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Toy example with image-like numpy arrays and binary label</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">ArrayDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="s2">&quot;Sample numpy array dataset&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># binary label</span>
    
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># 10 images (3x3)</span>
<span class="n">train_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">()</span> <span class="c1"># binary label</span>

<span class="n">valid_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">valid_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>

<span class="n">train_ds</span><span class="p">,</span> <span class="n">valid_ds</span> <span class="o">=</span> <span class="n">ArrayDataset</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">),</span> <span class="n">ArrayDataset</span><span class="p">(</span><span class="n">valid_x</span><span class="p">,</span> <span class="n">valid_y</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">DataBunch</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">valid_ds</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor([[[0.8053, 0.5914, 0.5369],
          [0.6880, 0.4680, 0.5457],
          [0.0051, 0.2096, 0.3469]],
 
         [[0.5170, 0.2542, 0.9869],
          [0.0176, 0.5049, 0.4417],
          [0.3495, 0.7276, 0.5426]]], dtype=torch.float64), tensor([[0.],
         [0.]], dtype=torch.float64))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="For-a-specific-application">For a specific application<a class="anchor-link" href="#For-a-specific-application">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In text, your dataset will need to have a <code>vocab</code> attribute that should be an instance of <a href="/text.transform.html#Vocab"><code>Vocab</code></a>. It's used by <a href="/text.learner.html#text_classifier_learner"><code>text_classifier_learner</code></a> and <a href="/text.learner.html#language_model_learner"><code>language_model_learner</code></a> when building the model.</p>
<p>In tabular, your dataset will need to have a <code>cont_names</code> attribute (for the names of continuous variables) and a <code>get_emb_szs</code> method that returns a list of tuple <code>(n_classes, emb_sz)</code> representing, for each categorical variable, the number of different codes (don't forget to add 1 for nan) and the corresponding embedding size. Those two are used with the <code>c</code> attribute by <a href="/tabular.learner.html#tabular_learner"><code>tabular_learner</code></a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Functions-that-really-won't-work">Functions that really won't work<a class="anchor-link" href="#Functions-that-really-won't-work">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To make those last functions work, you really need to use the <a href="/data_block.html">data block API</a> and maybe write your own <a href="/tutorial.itemlist.html">custom ItemList</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><a href="/basic_data.html#DataBunch.show_batch"><code>DataBunch.show_batch</code></a> (requires <code>.x.reconstruct</code>, <code>.y.reconstruct</code> and <code>.x.show_xys</code>)</li>
<li><a href="/basic_train.html#Learner.predict"><code>Learner.predict</code></a> (requires <code>x.set_item</code>, <code>.y.analyze_pred</code>, <code>.y.reconstruct</code> and maybe <code>.x.reconstruct</code>)</li>
<li><a href="/basic_train.html#Learner.show_results"><code>Learner.show_results</code></a> (requires <code>x.reconstruct</code>, <code>y.analyze_pred</code>, <code>y.reconstruct</code> and <code>x.show_xyzs</code>)</li>
<li><code>DataBunch.set_item</code> (requires <code>x.set_item</code>)</li>
<li><a href="/basic_train.html#Learner.backward"><code>Learner.backward</code></a> (uses <code>DataBunch.set_item</code>)</li>
<li><a href="/basic_data.html#DataBunch.export"><code>DataBunch.export</code></a> (requires <code>export</code>)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="DeviceDataLoader" class="doc_header"><code>class</code> <code>DeviceDataLoader</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L27" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#DeviceDataLoader-pytest" style="float:right; padding-right:10px">[test]</a></h2><blockquote><p><code>DeviceDataLoader</code>(<strong><code>dl</code></strong>:<a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a>, <strong><code>device</code></strong>:<a href="https://pytorch.org/docs/stable/tensor_attributes.html#torch-device"><code>device</code></a>, <strong><code>tfms</code></strong>:<code>List</code>[<code>Callable</code>]=<strong><em><code>None</code></em></strong>, <strong><code>collate_fn</code></strong>:<code>Callable</code>=<strong><em><code>'data_collate'</code></em></strong>)</p>
</blockquote>
<div class="collapse" id="DeviceDataLoader-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DeviceDataLoader-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>Tests found for <code>DeviceDataLoader</code>:</p><p>Some other tests where <code>DeviceDataLoader</code> is used:</p><ul><li><code>pytest -sv tests/test_basic_data.py::test_DeviceDataLoader_getitem</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_basic_data.py#L110" class="source_link" style="float:right">[source]</a></li></ul><p>To run tests please refer to this <a href="/dev/test.html#quick-guide">guide</a>.</p></div></div><p>Bind a <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a> to a <a href="https://pytorch.org/docs/stable/tensor_attributes.html#torch-device"><code>torch.device</code></a>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Put the batches of <code>dl</code> on <code>device</code> after applying an optional list of <code>tfms</code>. <code>collate_fn</code> will replace the one of <code>dl</code>. All dataloaders of a <a href="/basic_data.html#DataBunch"><code>DataBunch</code></a> are of this type.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Factory-method">Factory method<a class="anchor-link" href="#Factory-method">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="DeviceDataLoader.create" class="doc_header"><code>create</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L77" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#DeviceDataLoader-create-pytest" style="float:right; padding-right:10px">[test]</a></h4><blockquote><p><code>create</code>(<strong><code>dataset</code></strong>:<a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset"><code>Dataset</code></a>, <strong><code>bs</code></strong>:<code>int</code>=<strong><em><code>64</code></em></strong>, <strong><code>shuffle</code></strong>:<code>bool</code>=<strong><em><code>False</code></em></strong>, <strong><code>device</code></strong>:<a href="https://pytorch.org/docs/stable/tensor_attributes.html#torch-device"><code>device</code></a>=<strong><em><code>device(type='cuda')</code></em></strong>, <strong><code>tfms</code></strong>:<code>Collection</code>[<code>Callable</code>]=<strong><em><code>None</code></em></strong>, <strong><code>num_workers</code></strong>:<code>int</code>=<strong><em><code>16</code></em></strong>, <strong><code>collate_fn</code></strong>:<code>Callable</code>=<strong><em><code>'data_collate'</code></em></strong>, <strong>**<code>kwargs</code></strong>:<code>Any</code>)</p>
</blockquote>
<div class="collapse" id="DeviceDataLoader-create-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DeviceDataLoader-create-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>Tests found for <code>create</code>:</p><p>Some other tests where <code>create</code> is used:</p><ul><li><code>pytest -sv tests/test_basic_data.py::test_DataBunch_Create</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_basic_data.py#L30" class="source_link" style="float:right">[source]</a></li><li><code>pytest -sv tests/test_basic_data.py::test_DataBunch_no_valid_dl</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_basic_data.py#L45" class="source_link" style="float:right">[source]</a></li><li><code>pytest -sv tests/test_basic_data.py::test_DeviceDataLoader_getitem</code> <a href="https://github.com/fastai/fastai/blob/master/tests/test_basic_data.py#L110" class="source_link" style="float:right">[source]</a></li></ul><p>To run tests please refer to this <a href="/dev/test.html#quick-guide">guide</a>.</p></div></div><p>Create DeviceDataLoader from <code>dataset</code> with <code>bs</code> and <code>shuffle</code>: process using <code>num_workers</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The given <code>collate_fn</code> will be used to put the samples together in one batch (by default it grabs their data attribute). <code>shuffle</code> means the dataloader will take the samples randomly if that flag is set to <code>True</code>, or in the right order otherwise. <code>tfms</code> are passed to the init method. All <code>kwargs</code> are passed to the pytorch <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a> class initialization.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Methods">Methods<a class="anchor-link" href="#Methods">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="DeviceDataLoader.add_tfm" class="doc_header"><code>add_tfm</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L54" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#DeviceDataLoader-add_tfm-pytest" style="float:right; padding-right:10px">[test]</a></h4><blockquote><p><code>add_tfm</code>(<strong><code>tfm</code></strong>:<code>Callable</code>)</p>
</blockquote>
<div class="collapse" id="DeviceDataLoader-add_tfm-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DeviceDataLoader-add_tfm-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>No tests found for <code>add_tfm</code>. To contribute a test please refer to <a href="/dev/test.html">this guide</a> and <a href="https://forums.fast.ai/t/improving-expanding-functional-tests/32929">this discussion</a>.</p></div></div><p>Add <code>tfm</code> to <code>self.tfms</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="DeviceDataLoader.remove_tfm" class="doc_header"><code>remove_tfm</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L57" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#DeviceDataLoader-remove_tfm-pytest" style="float:right; padding-right:10px">[test]</a></h4><blockquote><p><code>remove_tfm</code>(<strong><code>tfm</code></strong>:<code>Callable</code>)</p>
</blockquote>
<div class="collapse" id="DeviceDataLoader-remove_tfm-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DeviceDataLoader-remove_tfm-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>No tests found for <code>remove_tfm</code>. To contribute a test please refer to <a href="/dev/test.html">this guide</a> and <a href="https://forums.fast.ai/t/improving-expanding-functional-tests/32929">this discussion</a>.</p></div></div><p>Remove <code>tfm</code> from <code>self.tfms</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="DeviceDataLoader.new" class="doc_header"><code>new</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L61" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#DeviceDataLoader-new-pytest" style="float:right; padding-right:10px">[test]</a></h4><blockquote><p><code>new</code>(<strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<div class="collapse" id="DeviceDataLoader-new-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DeviceDataLoader-new-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>No tests found for <code>new</code>. To contribute a test please refer to <a href="/dev/test.html">this guide</a> and <a href="https://forums.fast.ai/t/improving-expanding-functional-tests/32929">this discussion</a>.</p></div></div><p>Create a new copy of <code>self</code> with <code>kwargs</code> replacing current values.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="DeviceDataLoader.proc_batch" class="doc_header"><code>proc_batch</code><a href="https://github.com/fastai/fastai/blob/master/fastai/basic_data.py#L67" class="source_link" style="float:right">[source]</a><a class="source_link" data-toggle="collapse" data-target="#DeviceDataLoader-proc_batch-pytest" style="float:right; padding-right:10px">[test]</a></h4><blockquote><p><code>proc_batch</code>(<strong><code>b</code></strong>:<code>Tensor</code>) → <code>Tensor</code></p>
</blockquote>
<div class="collapse" id="DeviceDataLoader-proc_batch-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DeviceDataLoader-proc_batch-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>No tests found for <code>proc_batch</code>. To contribute a test please refer to <a href="/dev/test.html">this guide</a> and <a href="https://forums.fast.ai/t/improving-expanding-functional-tests/32929">this discussion</a>.</p></div></div><p>Process batch <code>b</code> of <code>TensorImage</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="DatasetType" class="doc_header">`DatasetType`<a class="source_link" data-toggle="collapse" data-target="#DatasetType-pytest" style="float:right; padding-right:10px">[test]</a></h2><blockquote><p><code>Enum</code> = [Train, Valid, Test, Single, Fix]</p>
</blockquote>
<div class="collapse" id="DatasetType-pytest"><div class="card card-body pytest_card"><a type="button" data-toggle="collapse" data-target="#DatasetType-pytest" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><p>No tests found for <code>DatasetType</code>. To contribute a test please refer to <a href="/dev/test.html">this guide</a> and <a href="https://forums.fast.ai/t/improving-expanding-functional-tests/32929">this discussion</a>.</p></div></div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Internal enumerator to name the training, validation and test dataset/dataloader.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Open-This-Notebook">Open This Notebook<a class="anchor-link" href="#Open-This-Notebook">&#182;</a></h2><button style="display: flex; align-item: center; padding: 4px 8px; font-size: 14px; font-weight: 700; color: #1976d2; cursor: pointer;" onclick="window.location.href = 'https://console.cloud.google.com/mlengine/notebooks/deploy-notebook?q=download_url%3Dhttps%253A%252F%252Fraw.githubusercontent.com%252Ffastai%252Ffastai%252Fmaster%252Fdocs_src%252Fbasic_data.ipynb';"><img src="https://www.gstatic.com/images/branding/product/1x/cloud_24dp.png" /><span style="line-height: 24px; margin-left: 10px;">Open in GCP Notebooks</span></button>
</div>
</div>
</div>
</div>
 

