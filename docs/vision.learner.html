---

title: Learner for the vision applications


keywords: fastai
sidebar: home_sidebar

summary: "All the functions necessary to build `Learner` suitable for transfer learning in computer vision"
description: "All the functions necessary to build `Learner` suitable for transfer learning in computer vision"
nb_path: "nbs/21_vision.learner.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/21_vision.learner.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/opt/conda/lib/python3.9/site-packages/torch/cuda/__init__.py:145: UserWarning: 
NVIDIA GeForce RTX 3070 Laptop GPU with CUDA capability sm_86 is not compatible with the current PyTorch installation.
The current PyTorch install supports CUDA capabilities sm_37 sm_50 sm_60 sm_70.
If you want to use the NVIDIA GeForce RTX 3070 Laptop GPU GPU with PyTorch, please check the instructions at https://pytorch.org/get-started/locally/

  warnings.warn(incompatible_device_warn.format(device_name, capability, &#34; &#34;.join(arch_list), device_name))
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The most important functions of this module are <a href="/vision.learner.html#vision_learner"><code>vision_learner</code></a> and <a href="/vision.learner.html#unet_learner"><code>unet_learner</code></a>. They will help you define a <a href="/learner.html#Learner"><code>Learner</code></a> using a pretrained model. See the <a href="http://docs.fast.ai/tutorial.vision">vision tutorial</a> for examples of use.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cut-a-pretrained-model">Cut a pretrained model<a class="anchor-link" href="#Cut-a-pretrained-model"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By default, the fastai library cuts a pretrained model at the pooling layer. This function helps detecting it.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="has_pool_type" class="doc_header"><code>has_pool_type</code><a href="https://github.com/fastai/fastai/tree/master/fastai/vision/learner.py#L21" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>has_pool_type</code>(<strong><code>m</code></strong>)</p>
</blockquote>
<p>Return <code>True</code> if <code>m</code> is a pooling layer or has one in its children</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">AdaptiveAvgPool2d</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool3d</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">has_pool_type</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="n">has_pool_type</span><span class="p">(</span><span class="n">m_</span><span class="p">)</span> <span class="k">for</span> <span class="n">m_</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">children</span><span class="p">()],</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cut_model" class="doc_header"><code>cut_model</code><a href="https://github.com/fastai/fastai/tree/master/fastai/vision/learner.py#L67" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cut_model</code>(<strong><code>model</code></strong>, <strong><code>cut</code></strong>)</p>
</blockquote>
<p>Cut an instantiated model</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_body" class="doc_header"><code>create_body</code><a href="https://github.com/fastai/fastai/tree/master/fastai/vision/learner.py#L74" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_body</code>(<strong><code>arch</code></strong>, <strong><code>n_in</code></strong>=<em><code>3</code></em>, <strong><code>pretrained</code></strong>=<em><code>True</code></em>, <strong><code>cut</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Cut off the body of a typically pretrained <code>arch</code> as determined by <code>cut</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>cut</code> can either be an integer, in which case we cut the model at the corresponding layer, or a function, in which case, this function returns <code>cut(model)</code>. It defaults to the first layer that contains some pooling otherwise.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tst</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">pretrained</span> <span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">AvgPool2d</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">create_body</span><span class="p">(</span><span class="n">tst</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">create_body</span><span class="p">(</span><span class="n">tst</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">create_body</span><span class="p">(</span><span class="n">tst</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="n">noop</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>    
    <span class="n">m</span> <span class="o">=</span> <span class="n">create_body</span><span class="p">(</span><span class="n">tst</span><span class="p">,</span> <span class="n">n_in</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
    <span class="n">test_eq</span><span class="p">(</span><span class="n">_get_first_layer</span><span class="p">(</span><span class="n">m</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">in_channels</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Head-and-model">Head and model<a class="anchor-link" href="#Head-and-model"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_head" class="doc_header"><code>create_head</code><a href="https://github.com/fastai/fastai/tree/master/fastai/vision/learner.py#L84" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_head</code>(<strong><code>nf</code></strong>, <strong><code>n_out</code></strong>, <strong><code>lin_ftrs</code></strong>=<em><code>None</code></em>, <strong><code>ps</code></strong>=<em><code>0.5</code></em>, <strong><code>pool</code></strong>=<em><code>True</code></em>, <strong><code>concat_pool</code></strong>=<em><code>True</code></em>, <strong><code>first_bn</code></strong>=<em><code>True</code></em>, <strong><code>bn_final</code></strong>=<em><code>False</code></em>, <strong><code>lin_first</code></strong>=<em><code>False</code></em>, <strong><code>y_range</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Model head that takes <code>nf</code> features, runs through <code>lin_ftrs</code>, and out <code>n_out</code> classes.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The head begins with fastai's <a href="/layers.html#AdaptiveConcatPool2d"><code>AdaptiveConcatPool2d</code></a> if <code>concat_pool=True</code> otherwise, it uses traditional average pooling. Then it uses a <a href="/layers.html#Flatten"><code>Flatten</code></a> layer before going on blocks of <a href="/layers.html#BatchNorm"><code>BatchNorm</code></a>, <code>Dropout</code> and <code>Linear</code> layers (if <code>lin_first=True</code>, those are <code>Linear</code>, <a href="/layers.html#BatchNorm"><code>BatchNorm</code></a>, <code>Dropout</code>).</p>
<p>Those blocks start at <code>nf</code>, then every element of <code>lin_ftrs</code> (defaults to <code>[512]</code>) and end at <code>n_out</code>. <code>ps</code> is a list of probabilities used for the dropouts (if you only pass 1, it will use half the value then that value as many times as necessary).</p>
<p>If <code>first_bn=True</code>, a <a href="/layers.html#BatchNorm"><code>BatchNorm</code></a> added just after the pooling operations. If <code>bn_final=True</code>, a final <a href="/layers.html#BatchNorm"><code>BatchNorm</code></a> layer is added. If <code>y_range</code> is passed, the function adds a <a href="/layers.html#SigmoidRange"><code>SigmoidRange</code></a> to that range.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tst</span> <span class="o">=</span> <span class="n">create_head</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">tst</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Sequential(
  (0): AdaptiveConcatPool2d(
    (ap): AdaptiveAvgPool2d(output_size=1)
    (mp): AdaptiveMaxPool2d(output_size=1)
  )
  (1): Flatten(full=False)
  (2): BatchNorm1d(10, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (3): Dropout(p=0.25, inplace=False)
  (4): Linear(in_features=10, out_features=512, bias=False)
  (5): ReLU(inplace=True)
  (6): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (7): Dropout(p=0.5, inplace=False)
  (8): Linear(in_features=512, out_features=10, bias=False)
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># class ModelSplitter():</span>
<span class="c1">#     def __init__(self, idx): self.idx = idx</span>
<span class="c1">#     def split(self, m): return L(m[:self.idx], m[self.idx:]).map(params)</span>
<span class="c1">#     def __call__(self,): return {&#39;cut&#39;:self.idx, &#39;split&#39;:self.split}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="default_split" class="doc_header"><code>default_split</code><a href="https://github.com/fastai/fastai/tree/master/fastai/vision/learner.py#L109" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>default_split</code>(<strong><code>m</code></strong>)</p>
</blockquote>
<p>Default split of a model between body and head</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To do transfer learning, you need to pass a <code>splitter</code> to <a href="/learner.html#Learner"><code>Learner</code></a>. This should be a function taking the model and returning a collection of parameter groups, e.g. a list of list of parameters.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_head" class="doc_header"><code>add_head</code><a href="https://github.com/fastai/fastai/tree/master/fastai/vision/learner.py#L148" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_head</code>(<strong><code>body</code></strong>, <strong><code>nf</code></strong>, <strong><code>n_out</code></strong>, <strong><code>init</code></strong>=<em><code>kaiming_normal_</code></em>, <strong><code>head</code></strong>=<em><code>None</code></em>, <strong><code>concat_pool</code></strong>=<em><code>True</code></em>, <strong><code>pool</code></strong>=<em><code>True</code></em>, <strong><code>lin_ftrs</code></strong>=<em><code>None</code></em>, <strong><code>ps</code></strong>=<em><code>0.5</code></em>, <strong><code>first_bn</code></strong>=<em><code>True</code></em>, <strong><code>bn_final</code></strong>=<em><code>False</code></em>, <strong><code>lin_first</code></strong>=<em><code>False</code></em>, <strong><code>y_range</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Add a head to a vision body</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_vision_model" class="doc_header"><code>create_vision_model</code><a href="https://github.com/fastai/fastai/tree/master/fastai/vision/learner.py#L159" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_vision_model</code>(<strong><code>arch</code></strong>, <strong><code>n_out</code></strong>, <strong><code>pretrained</code></strong>=<em><code>True</code></em>, <strong><code>cut</code></strong>=<em><code>None</code></em>, <strong><code>n_in</code></strong>=<em><code>3</code></em>, <strong><code>init</code></strong>=<em><code>kaiming_normal_</code></em>, <strong><code>custom_head</code></strong>=<em><code>None</code></em>, <strong><code>concat_pool</code></strong>=<em><code>True</code></em>, <strong><code>pool</code></strong>=<em><code>True</code></em>, <strong><code>lin_ftrs</code></strong>=<em><code>None</code></em>, <strong><code>ps</code></strong>=<em><code>0.5</code></em>, <strong><code>first_bn</code></strong>=<em><code>True</code></em>, <strong><code>bn_final</code></strong>=<em><code>False</code></em>, <strong><code>lin_first</code></strong>=<em><code>False</code></em>, <strong><code>y_range</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create custom vision architecture</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The model is cut according to <code>cut</code> and it may be <code>pretrained</code>, in which case, the proper set of weights is downloaded then loaded. <code>init</code> is applied to the head of the model, which is either created by <a href="/vision.learner.html#create_head"><code>create_head</code></a> (with <code>lin_ftrs</code>, <code>ps</code>, <code>concat_pool</code>, <code>bn_final</code>, <code>lin_first</code> and <code>y_range</code>) or is <code>custom_head</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tst</span> <span class="o">=</span> <span class="n">create_vision_model</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">resnet18</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">tst</span> <span class="o">=</span> <span class="n">create_vision_model</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">resnet18</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">n_in</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TimmBody" class="doc_header"><code>class</code> <code>TimmBody</code><a href="https://github.com/fastai/fastai/tree/master/fastai/vision/learner.py#L169" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TimmBody</code>(<strong><code>arch</code></strong>:<code>str</code>, <strong><code>pretrained</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>cut</code></strong>=<em><code>None</code></em>, <strong><code>n_in</code></strong>:<code>int</code>=<em><code>3</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/torch_core.html#Module"><code>Module</code></a></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>.. note::
    As per the example above, an <code>__init__()</code> call to the parent class
    must be made before assignment on the child.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_timm_model" class="doc_header"><code>create_timm_model</code><a href="https://github.com/fastai/fastai/tree/master/fastai/vision/learner.py#L179" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_timm_model</code>(<strong><code>arch</code></strong>:<code>str</code>, <strong><code>n_out</code></strong>, <strong><code>cut</code></strong>=<em><code>None</code></em>, <strong><code>pretrained</code></strong>=<em><code>True</code></em>, <strong><code>n_in</code></strong>=<em><code>3</code></em>, <strong><code>init</code></strong>=<em><code>kaiming_normal_</code></em>, <strong><code>custom_head</code></strong>=<em><code>None</code></em>, <strong><code>concat_pool</code></strong>=<em><code>True</code></em>, <strong><code>pool</code></strong>=<em><code>True</code></em>, <strong><code>lin_ftrs</code></strong>=<em><code>None</code></em>, <strong><code>ps</code></strong>=<em><code>0.5</code></em>, <strong><code>first_bn</code></strong>=<em><code>True</code></em>, <strong><code>bn_final</code></strong>=<em><code>False</code></em>, <strong><code>lin_first</code></strong>=<em><code>False</code></em>, <strong><code>y_range</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Create custom architecture using <code>arch</code>, <code>n_in</code> and <code>n_out</code> from the <code>timm</code> library</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Learner-convenience-functions"><a href="/learner.html#Learner"><code>Learner</code></a> convenience functions<a class="anchor-link" href="#Learner-convenience-functions"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="vision_learner" class="doc_header"><code>vision_learner</code><a href="https://github.com/fastai/fastai/tree/master/fastai/vision/learner.py#L196" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>vision_learner</code>(<strong><code>dls</code></strong>, <strong><code>arch</code></strong>, <strong><code>normalize</code></strong>=<em><code>True</code></em>, <strong><code>n_out</code></strong>=<em><code>None</code></em>, <strong><code>pretrained</code></strong>=<em><code>True</code></em>, <strong><code>loss_func</code></strong>=<em><code>None</code></em>, <strong><code>opt_func</code></strong>=<em><code>Adam</code></em>, <strong><code>lr</code></strong>=<em><code>0.001</code></em>, <strong><code>splitter</code></strong>=<em><code>None</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>metrics</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>model_dir</code></strong>=<em><code>'models'</code></em>, <strong><code>wd</code></strong>=<em><code>None</code></em>, <strong><code>wd_bn_bias</code></strong>=<em><code>False</code></em>, <strong><code>train_bn</code></strong>=<em><code>True</code></em>, <strong><code>moms</code></strong>=<em><code>(0.95, 0.85, 0.95)</code></em>, <strong><code>cut</code></strong>=<em><code>None</code></em>, <strong><code>init</code></strong>=<em><code>kaiming_normal_</code></em>, <strong><code>custom_head</code></strong>=<em><code>None</code></em>, <strong><code>concat_pool</code></strong>=<em><code>True</code></em>, <strong><code>pool</code></strong>=<em><code>True</code></em>, <strong><code>lin_ftrs</code></strong>=<em><code>None</code></em>, <strong><code>ps</code></strong>=<em><code>0.5</code></em>, <strong><code>first_bn</code></strong>=<em><code>True</code></em>, <strong><code>bn_final</code></strong>=<em><code>False</code></em>, <strong><code>lin_first</code></strong>=<em><code>False</code></em>, <strong><code>y_range</code></strong>=<em><code>None</code></em>, <strong><code>n_in</code></strong>=<em><code>3</code></em>)</p>
</blockquote>
<p>Build a vision learner from <code>dls</code> and <code>arch</code></p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>dls</code></strong></td>
<td></td>
<td></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>normalize</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>loss_func</code></strong></td>
<td></td>
<td><code>None</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>opt_func</code></strong></td>
<td><code>function</code></td>
<td><a href="/optimizer.html#Adam"><code>Adam</code></a></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>lr</code></strong></td>
<td><code>float</code></td>
<td><code>0.001</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>splitter</code></strong></td>
<td></td>
<td><code>None</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>cbs</code></strong></td>
<td></td>
<td><code>None</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>metrics</code></strong></td>
<td></td>
<td><code>None</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>path</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>learner args</td>
</tr>
<tr>
<td><strong><code>model_dir</code></strong></td>
<td><code>str</code></td>
<td><code>models</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>wd</code></strong></td>
<td></td>
<td><code>None</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>wd_bn_bias</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>train_bn</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>moms</code></strong></td>
<td><code>tuple</code></td>
<td><code>(0.95, 0.85, 0.95)</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>pool</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>model &amp; head args</td>
</tr>
<tr>
<td></td>
<td></td>
<td><strong>Valid Keyword Arguments</strong></td>
<td></td>
</tr>
<tr>
<td><strong><code>arch</code></strong></td>
<td></td>
<td></td>
<td>Argument passed to <a href="/vision.learner.html#create_vision_model"><code>create_vision_model</code></a></td>
</tr>
<tr>
<td><strong><code>n_out</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_vision_model"><code>create_vision_model</code></a></td>
</tr>
<tr>
<td><strong><code>pretrained</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_vision_model"><code>create_vision_model</code></a></td>
</tr>
<tr>
<td><strong><code>cut</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_vision_model"><code>create_vision_model</code></a></td>
</tr>
<tr>
<td><strong><code>init</code></strong></td>
<td><code>function</code></td>
<td><code>kaiming_normal_</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_vision_model"><code>create_vision_model</code></a></td>
</tr>
<tr>
<td><strong><code>custom_head</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_vision_model"><code>create_vision_model</code></a></td>
</tr>
<tr>
<td><strong><code>concat_pool</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_vision_model"><code>create_vision_model</code></a></td>
</tr>
<tr>
<td><strong><code>lin_ftrs</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_vision_model"><code>create_vision_model</code></a></td>
</tr>
<tr>
<td><strong><code>ps</code></strong></td>
<td><code>float</code></td>
<td><code>0.5</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_vision_model"><code>create_vision_model</code></a></td>
</tr>
<tr>
<td><strong><code>first_bn</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_vision_model"><code>create_vision_model</code></a></td>
</tr>
<tr>
<td><strong><code>bn_final</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_vision_model"><code>create_vision_model</code></a></td>
</tr>
<tr>
<td><strong><code>lin_first</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_vision_model"><code>create_vision_model</code></a></td>
</tr>
<tr>
<td><strong><code>y_range</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_vision_model"><code>create_vision_model</code></a></td>
</tr>
<tr>
<td><strong><code>n_in</code></strong></td>
<td><code>int</code></td>
<td><code>3</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_vision_model"><code>create_vision_model</code></a></td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The model is built from <code>arch</code> using the number of final activations inferred from <code>dls</code> if possible (otherwise pass a value to <code>n_out</code>). It might be <code>pretrained</code> and the architecture is cut and split using the default metadata of the model architecture (this can be customized by passing a <code>cut</code> or a <code>splitter</code>).</p>
<p>If <code>normalize</code> and <code>pretrained</code> are <code>True</code>, this function adds a <code>Normalization</code> transform to the <code>dls</code> (if there is not already one) using the statistics of the pretrained model. That way, you won't ever forget to normalize your data in transfer learning.</p>
<p>All other arguments are passed to <a href="/learner.html#Learner"><code>Learner</code></a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">PETS</span><span class="p">)</span>
<span class="n">fnames</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s2">&quot;images&quot;</span><span class="p">)</span>
<span class="n">pat</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;^(.*)_\d+.jpg$&#39;</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">ImageDataLoaders</span><span class="o">.</span><span class="n">from_name_re</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">fnames</span><span class="p">,</span> <span class="n">pat</span><span class="p">,</span> <span class="n">item_tfms</span><span class="o">=</span><span class="n">Resize</span><span class="p">(</span><span class="mi">224</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">vision_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">models</span><span class="o">.</span><span class="n">resnet18</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span> <span class="n">ps</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you pass a <code>str</code> to <code>arch</code>, then a <a href="https://fastai.github.io/timmdocs/models">TIMM</a> model will be created:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">vision_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="s1">&#39;vit_tiny_patch16_224&#39;</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span> <span class="n">ps</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_unet_model" class="doc_header"><code>create_unet_model</code><a href="https://github.com/fastai/fastai/tree/master/fastai/vision/learner.py#L223" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_unet_model</code>(<strong><code>arch</code></strong>, <strong><code>n_out</code></strong>, <strong><code>img_size</code></strong>, <strong><code>pretrained</code></strong>=<em><code>True</code></em>, <strong><code>cut</code></strong>=<em><code>None</code></em>, <strong><code>n_in</code></strong>=<em><code>3</code></em>, <strong><code>blur</code></strong>=<em><code>False</code></em>, <strong><code>blur_final</code></strong>=<em><code>True</code></em>, <strong><code>self_attention</code></strong>=<em><code>False</code></em>, <strong><code>y_range</code></strong>=<em><code>None</code></em>, <strong><code>last_cross</code></strong>=<em><code>True</code></em>, <strong><code>bottle</code></strong>=<em><code>False</code></em>, <strong><code>act_cls</code></strong>=<em><code>ReLU</code></em>, <strong><code>init</code></strong>=<em><code>kaiming_normal_</code></em>, <strong><code>norm_type</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create custom unet architecture</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tst</span> <span class="o">=</span> <span class="n">create_unet_model</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">resnet18</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="mi">24</span><span class="p">),</span> <span class="kc">True</span><span class="p">,</span> <span class="n">n_in</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="unet_learner" class="doc_header"><code>unet_learner</code><a href="https://github.com/fastai/fastai/tree/master/fastai/vision/learner.py#L232" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>unet_learner</code>(<strong><code>dls</code></strong>, <strong><code>arch</code></strong>, <strong><code>normalize</code></strong>=<em><code>True</code></em>, <strong><code>n_out</code></strong>=<em><code>None</code></em>, <strong><code>pretrained</code></strong>=<em><code>True</code></em>, <strong><code>config</code></strong>=<em><code>None</code></em>, <strong><code>loss_func</code></strong>=<em><code>None</code></em>, <strong><code>opt_func</code></strong>=<em><code>Adam</code></em>, <strong><code>lr</code></strong>=<em><code>0.001</code></em>, <strong><code>splitter</code></strong>=<em><code>None</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>metrics</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>model_dir</code></strong>=<em><code>'models'</code></em>, <strong><code>wd</code></strong>=<em><code>None</code></em>, <strong><code>wd_bn_bias</code></strong>=<em><code>False</code></em>, <strong><code>train_bn</code></strong>=<em><code>True</code></em>, <strong><code>moms</code></strong>=<em><code>(0.95, 0.85, 0.95)</code></em>, <strong><code>cut</code></strong>=<em><code>None</code></em>, <strong><code>n_in</code></strong>=<em><code>3</code></em>, <strong><code>blur</code></strong>=<em><code>False</code></em>, <strong><code>blur_final</code></strong>=<em><code>True</code></em>, <strong><code>self_attention</code></strong>=<em><code>False</code></em>, <strong><code>y_range</code></strong>=<em><code>None</code></em>, <strong><code>last_cross</code></strong>=<em><code>True</code></em>, <strong><code>bottle</code></strong>=<em><code>False</code></em>, <strong><code>act_cls</code></strong>=<em><code>ReLU</code></em>, <strong><code>init</code></strong>=<em><code>kaiming_normal_</code></em>, <strong><code>norm_type</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Build a unet learner from <code>dls</code> and <code>arch</code></p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>dls</code></strong></td>
<td></td>
<td></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>normalize</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>config</code></strong></td>
<td></td>
<td><code>None</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>loss_func</code></strong></td>
<td></td>
<td><code>None</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>opt_func</code></strong></td>
<td><code>function</code></td>
<td><a href="/optimizer.html#Adam"><code>Adam</code></a></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>lr</code></strong></td>
<td><code>float</code></td>
<td><code>0.001</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>splitter</code></strong></td>
<td></td>
<td><code>None</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>cbs</code></strong></td>
<td></td>
<td><code>None</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>metrics</code></strong></td>
<td></td>
<td><code>None</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>path</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>learner args</td>
</tr>
<tr>
<td><strong><code>model_dir</code></strong></td>
<td><code>str</code></td>
<td><code>models</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>wd</code></strong></td>
<td></td>
<td><code>None</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>wd_bn_bias</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>train_bn</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>moms</code></strong></td>
<td><code>tuple</code></td>
<td><code>(0.95, 0.85, 0.95)</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td></td>
<td></td>
<td><strong>Valid Keyword Arguments</strong></td>
<td></td>
</tr>
<tr>
<td><strong><code>arch</code></strong></td>
<td></td>
<td></td>
<td>Argument passed to <a href="/vision.learner.html#create_unet_model"><code>create_unet_model</code></a></td>
</tr>
<tr>
<td><strong><code>n_out</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_unet_model"><code>create_unet_model</code></a></td>
</tr>
<tr>
<td><strong><code>pretrained</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_unet_model"><code>create_unet_model</code></a></td>
</tr>
<tr>
<td><strong><code>cut</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_unet_model"><code>create_unet_model</code></a></td>
</tr>
<tr>
<td><strong><code>n_in</code></strong></td>
<td><code>int</code></td>
<td><code>3</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_unet_model"><code>create_unet_model</code></a></td>
</tr>
<tr>
<td><strong><code>blur</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_unet_model"><code>create_unet_model</code></a></td>
</tr>
<tr>
<td><strong><code>blur_final</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_unet_model"><code>create_unet_model</code></a></td>
</tr>
<tr>
<td><strong><code>self_attention</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_unet_model"><code>create_unet_model</code></a></td>
</tr>
<tr>
<td><strong><code>y_range</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_unet_model"><code>create_unet_model</code></a></td>
</tr>
<tr>
<td><strong><code>last_cross</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_unet_model"><code>create_unet_model</code></a></td>
</tr>
<tr>
<td><strong><code>bottle</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_unet_model"><code>create_unet_model</code></a></td>
</tr>
<tr>
<td><strong><code>act_cls</code></strong></td>
<td><code>type</code></td>
<td><code>ReLU</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_unet_model"><code>create_unet_model</code></a></td>
</tr>
<tr>
<td><strong><code>init</code></strong></td>
<td><code>function</code></td>
<td><code>kaiming_normal_</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_unet_model"><code>create_unet_model</code></a></td>
</tr>
<tr>
<td><strong><code>norm_type</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/vision.learner.html#create_unet_model"><code>create_unet_model</code></a></td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The model is built from <code>arch</code> using the number of final filters inferred from <code>dls</code> if possible (otherwise pass a value to <code>n_out</code>). It might be <code>pretrained</code> and the architecture is cut and split using the default metadata of the model architecture (this can be customized by passing a <code>cut</code> or a <code>splitter</code>).</p>
<p>If <code>normalize</code> and <code>pretrained</code> are <code>True</code>, this function adds a <code>Normalization</code> transform to the <code>dls</code> (if there is not already one) using the statistics of the pretrained model. That way, you won't ever forget to normalize your data in transfer learning.</p>
<p>All other arguments are passed to <a href="/learner.html#Learner"><code>Learner</code></a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">CAMVID_TINY</span><span class="p">)</span>
<span class="n">fnames</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;images&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">label_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;labels&#39;</span><span class="o">/</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s1">_P</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">codes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;codes.txt&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
    
<span class="n">dls</span> <span class="o">=</span> <span class="n">SegmentationDataLoaders</span><span class="o">.</span><span class="n">from_label_func</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">fnames</span><span class="p">,</span> <span class="n">label_func</span><span class="p">,</span> <span class="n">codes</span><span class="o">=</span><span class="n">codes</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/opt/conda/lib/python3.7/site-packages/torch/_tensor.py:1051: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the &#39;trunc&#39; function NOT &#39;floor&#39;). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode=&#39;trunc&#39;), or for actual floor division, use torch.div(a, b, rounding_mode=&#39;floor&#39;).
  ret = func(*args, **kwargs)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">unet_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">models</span><span class="o">.</span><span class="n">resnet34</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_cnn_model" class="doc_header"><code>create_cnn_model</code><a href="https://github.com/fastai/fastai/tree/master/fastai/vision/learner.py#L262" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_cnn_model</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Deprecated name for <a href="/vision.learner.html#create_vision_model"><code>create_vision_model</code></a> -- do not use</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cnn_learner" class="doc_header"><code>cnn_learner</code><a href="https://github.com/fastai/fastai/tree/master/fastai/vision/learner.py#L268" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cnn_learner</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Deprecated name for <a href="/vision.learner.html#vision_learner"><code>vision_learner</code></a> -- do not use</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

