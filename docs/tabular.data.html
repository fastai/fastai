---

title: Tabular data


keywords: fastai
sidebar: home_sidebar

summary: "Helper functions to get data in a `DataLoaders` in the tabular application and higher class `TabularDataLoaders`"
description: "Helper functions to get data in a `DataLoaders` in the tabular application and higher class `TabularDataLoaders`"
nb_path: "nbs/41_tabular.data.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/41_tabular.data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/opt/conda/lib/python3.9/site-packages/torch/cuda/__init__.py:145: UserWarning: 
NVIDIA GeForce RTX 3070 Laptop GPU with CUDA capability sm_86 is not compatible with the current PyTorch installation.
The current PyTorch install supports CUDA capabilities sm_37 sm_50 sm_60 sm_70.
If you want to use the NVIDIA GeForce RTX 3070 Laptop GPU GPU with PyTorch, please check the instructions at https://pytorch.org/get-started/locally/

  warnings.warn(incompatible_device_warn.format(device_name, capability, &#34; &#34;.join(arch_list), device_name))
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The main class to get your data ready for model training is <a href="/tabular.data.html#TabularDataLoaders"><code>TabularDataLoaders</code></a> and its factory methods. Checkout the <a href="http://docs.fast.ai/tutorial.tabular">tabular tutorial</a> for examples of use.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TabularDataLoaders" class="doc_header"><code>class</code> <code>TabularDataLoaders</code><a href="https://github.com/fastai/fastai/tree/master/fastai/tabular/data.py#L11" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TabularDataLoaders</code>(<strong>*<code>loaders</code></strong>, <strong><code>path</code></strong>:<code>(str, Path)</code>=<em><code>'.'</code></em>, <strong><code>device</code></strong>=<em><code>None</code></em>) :: <a href="/data.core.html#DataLoaders"><code>DataLoaders</code></a></p>
</blockquote>
<p>Basic wrapper around several <a href="/data.load.html#DataLoader"><code>DataLoader</code></a>s with factory methods for tabular data</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This class should not be used directly, one of the factory methods should be preferred instead. All those factory methods accept as arguments:</p>
<ul>
<li><code>cat_names</code>: the names of the categorical variables</li>
<li><code>cont_names</code>: the names of the continuous variables</li>
<li><code>y_names</code>: the names of the dependent variables</li>
<li><code>y_block</code>: the <a href="/data.block.html#TransformBlock"><code>TransformBlock</code></a> to use for the target</li>
<li><code>valid_idx</code>: the indices to use for the validation set (defaults to a random split otherwise)</li>
<li><code>bs</code>: the batch size</li>
<li><code>val_bs</code>: the batch size for the validation <a href="/data.load.html#DataLoader"><code>DataLoader</code></a> (defaults to <code>bs</code>)</li>
<li><code>shuffle_train</code>: if we shuffle the training <a href="/data.load.html#DataLoader"><code>DataLoader</code></a> or not</li>
<li><code>n</code>: overrides the numbers of elements in the dataset</li>
<li><code>device</code>: the PyTorch device to use (defaults to <code>default_device()</code>)</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="TabularDataLoaders.from_df" class="doc_header"><code>TabularDataLoaders.from_df</code><a href="https://github.com/fastai/fastai/tree/master/fastai/tabular/data.py#L13" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>TabularDataLoaders.from_df</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>path</code></strong>:<code>(str, Path)</code>=<em><code>'.'</code></em>, <strong><code>procs</code></strong>:<code>list</code>=<em><code>None</code></em>, <strong><code>cat_names</code></strong>:<code>list</code>=<em><code>None</code></em>, <strong><code>cont_names</code></strong>:<code>list</code>=<em><code>None</code></em>, <strong><code>y_names</code></strong>:<code>list</code>=<em><code>None</code></em>, <strong><code>y_block</code></strong>:<a href="/data.block.html#TransformBlock"><code>TransformBlock</code></a>=<em><code>None</code></em>, <strong><code>valid_idx</code></strong>:<code>list</code>=<em><code>None</code></em>, <strong><code>bs</code></strong>:<code>int</code>=<em><code>64</code></em>, <strong><code>shuffle_train</code></strong>:<code>bool</code>=<em><code>None</code></em>, <strong><code>shuffle</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>val_shuffle</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>n</code></strong>:<code>int</code>=<em><code>None</code></em>, <strong><code>device</code></strong>:<code>device</code>=<em><code>None</code></em>, <strong><code>drop_last</code></strong>:<code>bool</code>=<em><code>None</code></em>, <strong><code>val_bs</code></strong>:<code>int</code>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create <a href="/tabular.data.html#TabularDataLoaders"><code>TabularDataLoaders</code></a> from <code>df</code> in <code>path</code> using <code>procs</code></p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>df</code></strong></td>
<td><code>DataFrame</code></td>
<td></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>path</code></strong></td>
<td><code>(str, Path)</code></td>
<td><code>.</code></td>
<td>Location of <code>df</code>, defaults to current working directory</td>
</tr>
<tr>
<td><strong><code>procs</code></strong></td>
<td><code>list</code></td>
<td><code>None</code></td>
<td>List of <a href="/tabular.core.html#TabularProc"><code>TabularProc</code></a>s</td>
</tr>
<tr>
<td><strong><code>cat_names</code></strong></td>
<td><code>list</code></td>
<td><code>None</code></td>
<td>Column names pertaining to categorical variables</td>
</tr>
<tr>
<td><strong><code>cont_names</code></strong></td>
<td><code>list</code></td>
<td><code>None</code></td>
<td>Column names pertaining to continuous variables</td>
</tr>
<tr>
<td><strong><code>y_names</code></strong></td>
<td><code>list</code></td>
<td><code>None</code></td>
<td>Names of the dependent variables</td>
</tr>
<tr>
<td><strong><code>y_block</code></strong></td>
<td><a href="/data.block.html#TransformBlock"><code>TransformBlock</code></a></td>
<td><code>None</code></td>
<td><a href="/data.block.html#TransformBlock"><code>TransformBlock</code></a> to use for the target(s)</td>
</tr>
<tr>
<td><strong><code>valid_idx</code></strong></td>
<td><code>list</code></td>
<td><code>None</code></td>
<td>List of indices to use for the validation set, defaults to a random split</td>
</tr>
<tr>
<td></td>
<td></td>
<td><strong>Valid Keyword Arguments</strong></td>
<td></td>
</tr>
<tr>
<td><strong><code>bs</code></strong></td>
<td><code>int</code></td>
<td><code>64</code></td>
<td>Batch size passed to <a href="/data.core.html#FilteredBase.dataloaders"><code>FilteredBase.dataloaders</code></a></td>
</tr>
<tr>
<td><strong><code>shuffle_train</code></strong></td>
<td><code>bool</code></td>
<td><code>None</code></td>
<td>(Deprecated, use <code>shuffle</code>) Shuffle training <a href="/data.load.html#DataLoader"><code>DataLoader</code></a> passed to <a href="/data.core.html#FilteredBase.dataloaders"><code>FilteredBase.dataloaders</code></a></td>
</tr>
<tr>
<td><strong><code>shuffle</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Shuffle training <a href="/data.load.html#DataLoader"><code>DataLoader</code></a> passed to <a href="/data.core.html#FilteredBase.dataloaders"><code>FilteredBase.dataloaders</code></a></td>
</tr>
<tr>
<td><strong><code>val_shuffle</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Shuffle validation <a href="/data.load.html#DataLoader"><code>DataLoader</code></a> passed to <a href="/data.core.html#FilteredBase.dataloaders"><code>FilteredBase.dataloaders</code></a></td>
</tr>
<tr>
<td><strong><code>n</code></strong></td>
<td><code>int</code></td>
<td><code>None</code></td>
<td>Size of <a href="/data.core.html#Datasets"><code>Datasets</code></a> used to create <a href="/data.load.html#DataLoader"><code>DataLoader</code></a> passed to <a href="/data.core.html#FilteredBase.dataloaders"><code>FilteredBase.dataloaders</code></a></td>
</tr>
<tr>
<td><strong><code>device</code></strong></td>
<td><code>device</code></td>
<td><code>None</code></td>
<td>Device to put <a href="/data.core.html#DataLoaders"><code>DataLoaders</code></a> passed to <a href="/data.core.html#FilteredBase.dataloaders"><code>FilteredBase.dataloaders</code></a></td>
</tr>
<tr>
<td><strong><code>drop_last</code></strong></td>
<td><code>bool</code></td>
<td><code>None</code></td>
<td>Drop last incomplete batch, defaults to <code>shuffle</code> passed to <a href="/data.core.html#FilteredBase.dataloaders"><code>FilteredBase.dataloaders</code></a></td>
</tr>
<tr>
<td><strong><code>val_bs</code></strong></td>
<td><code>int</code></td>
<td><code>None</code></td>
<td>Validation batch size, defaults to <code>bs</code> passed to <a href="/data.core.html#FilteredBase.dataloaders"><code>FilteredBase.dataloaders</code></a></td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's have a look on an example with the adult dataset:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">ADULT_SAMPLE</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;adult.csv&#39;</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>fnlwgt</th>
      <th>education</th>
      <th>education-num</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>sex</th>
      <th>capital-gain</th>
      <th>capital-loss</th>
      <th>hours-per-week</th>
      <th>native-country</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>49</td>
      <td>Private</td>
      <td>101320</td>
      <td>Assoc-acdm</td>
      <td>12.0</td>
      <td>Married-civ-spouse</td>
      <td>NaN</td>
      <td>Wife</td>
      <td>White</td>
      <td>Female</td>
      <td>0</td>
      <td>1902</td>
      <td>40</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>1</th>
      <td>44</td>
      <td>Private</td>
      <td>236746</td>
      <td>Masters</td>
      <td>14.0</td>
      <td>Divorced</td>
      <td>Exec-managerial</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>Male</td>
      <td>10520</td>
      <td>0</td>
      <td>45</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>Private</td>
      <td>96185</td>
      <td>HS-grad</td>
      <td>NaN</td>
      <td>Divorced</td>
      <td>NaN</td>
      <td>Unmarried</td>
      <td>Black</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>32</td>
      <td>United-States</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>3</th>
      <td>38</td>
      <td>Self-emp-inc</td>
      <td>112847</td>
      <td>Prof-school</td>
      <td>15.0</td>
      <td>Married-civ-spouse</td>
      <td>Prof-specialty</td>
      <td>Husband</td>
      <td>Asian-Pac-Islander</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>4</th>
      <td>42</td>
      <td>Self-emp-not-inc</td>
      <td>82297</td>
      <td>7th-8th</td>
      <td>NaN</td>
      <td>Married-civ-spouse</td>
      <td>Other-service</td>
      <td>Wife</td>
      <td>Black</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
      <td>United-States</td>
      <td>&lt;50k</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;workclass&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;marital-status&#39;</span><span class="p">,</span> <span class="s1">&#39;occupation&#39;</span><span class="p">,</span> <span class="s1">&#39;relationship&#39;</span><span class="p">,</span> <span class="s1">&#39;race&#39;</span><span class="p">]</span>
<span class="n">cont_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;fnlwgt&#39;</span><span class="p">,</span> <span class="s1">&#39;education-num&#39;</span><span class="p">]</span>
<span class="n">procs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Categorify</span><span class="p">,</span> <span class="n">FillMissing</span><span class="p">,</span> <span class="n">Normalize</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">TabularDataLoaders</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">procs</span><span class="o">=</span><span class="n">procs</span><span class="p">,</span> <span class="n">cat_names</span><span class="o">=</span><span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="o">=</span><span class="n">cont_names</span><span class="p">,</span> 
                                 <span class="n">y_names</span><span class="o">=</span><span class="s2">&quot;salary&quot;</span><span class="p">,</span> <span class="n">valid_idx</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span><span class="mi">1000</span><span class="p">)),</span> <span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>workclass</th>
      <th>education</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>education-num_na</th>
      <th>age</th>
      <th>fnlwgt</th>
      <th>education-num</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Married-civ-spouse</td>
      <td>Adm-clerical</td>
      <td>Husband</td>
      <td>White</td>
      <td>False</td>
      <td>24.0</td>
      <td>121312.998272</td>
      <td>9.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Never-married</td>
      <td>Other-service</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>False</td>
      <td>19.0</td>
      <td>198320.000325</td>
      <td>9.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Private</td>
      <td>Bachelors</td>
      <td>Married-civ-spouse</td>
      <td>Sales</td>
      <td>Husband</td>
      <td>White</td>
      <td>False</td>
      <td>66.0</td>
      <td>169803.999308</td>
      <td>13.0</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Divorced</td>
      <td>Adm-clerical</td>
      <td>Unmarried</td>
      <td>White</td>
      <td>False</td>
      <td>40.0</td>
      <td>799280.980929</td>
      <td>9.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Local-gov</td>
      <td>10th</td>
      <td>Never-married</td>
      <td>Other-service</td>
      <td>Own-child</td>
      <td>White</td>
      <td>False</td>
      <td>18.0</td>
      <td>55658.003629</td>
      <td>6.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Never-married</td>
      <td>Handlers-cleaners</td>
      <td>Other-relative</td>
      <td>White</td>
      <td>False</td>
      <td>30.0</td>
      <td>375827.003847</td>
      <td>9.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Private</td>
      <td>Some-college</td>
      <td>Never-married</td>
      <td>Handlers-cleaners</td>
      <td>Own-child</td>
      <td>White</td>
      <td>False</td>
      <td>20.0</td>
      <td>173723.999335</td>
      <td>10.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>7</th>
      <td>?</td>
      <td>Some-college</td>
      <td>Never-married</td>
      <td>?</td>
      <td>Own-child</td>
      <td>White</td>
      <td>False</td>
      <td>21.0</td>
      <td>107800.997986</td>
      <td>10.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Never-married</td>
      <td>Handlers-cleaners</td>
      <td>Own-child</td>
      <td>White</td>
      <td>False</td>
      <td>19.0</td>
      <td>263338.000072</td>
      <td>9.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Private</td>
      <td>Some-college</td>
      <td>Married-civ-spouse</td>
      <td>Tech-support</td>
      <td>Husband</td>
      <td>White</td>
      <td>False</td>
      <td>35.0</td>
      <td>194590.999986</td>
      <td>10.0</td>
      <td>&lt;50k</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="TabularDataLoaders.from_csv" class="doc_header"><code>TabularDataLoaders.from_csv</code><a href="https://github.com/fastai/fastai/tree/master/fastai/tabular/data.py#L33" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>TabularDataLoaders.from_csv</code>(<strong><code>csv</code></strong>:<code>(str, Path, BufferedReader)</code>, <strong><code>skipinitialspace</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>path</code></strong>:<code>(str, Path)</code>=<em><code>'.'</code></em>, <strong><code>procs</code></strong>:<code>list</code>=<em><code>None</code></em>, <strong><code>cat_names</code></strong>:<code>list</code>=<em><code>None</code></em>, <strong><code>cont_names</code></strong>:<code>list</code>=<em><code>None</code></em>, <strong><code>y_names</code></strong>:<code>list</code>=<em><code>None</code></em>, <strong><code>y_block</code></strong>:<a href="/data.block.html#TransformBlock"><code>TransformBlock</code></a>=<em><code>None</code></em>, <strong><code>valid_idx</code></strong>:<code>list</code>=<em><code>None</code></em>, <strong><code>bs</code></strong>:<code>int</code>=<em><code>64</code></em>, <strong><code>shuffle_train</code></strong>:<code>bool</code>=<em><code>None</code></em>, <strong><code>shuffle</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>val_shuffle</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>n</code></strong>:<code>int</code>=<em><code>None</code></em>, <strong><code>device</code></strong>:<code>device</code>=<em><code>None</code></em>, <strong><code>drop_last</code></strong>:<code>bool</code>=<em><code>None</code></em>, <strong><code>val_bs</code></strong>:<code>int</code>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create <a href="/tabular.data.html#TabularDataLoaders"><code>TabularDataLoaders</code></a> from <code>csv</code> file in <code>path</code> using <code>procs</code></p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>csv</code></strong></td>
<td><code>(str, Path, BufferedReader)</code></td>
<td></td>
<td>A csv of training data</td>
</tr>
<tr>
<td><strong><code>skipinitialspace</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Skip spaces after delimiter</td>
</tr>
<tr>
<td></td>
<td></td>
<td><strong>Valid Keyword Arguments</strong></td>
<td></td>
</tr>
<tr>
<td><strong><code>path</code></strong></td>
<td><code>(str, Path)</code></td>
<td><code>.</code></td>
<td>Location of <code>df</code>, defaults to current working directory passed to <a href="/tabular.data.html#TabularDataLoaders.from_df"><code>TabularDataLoaders.from_df</code></a></td>
</tr>
<tr>
<td><strong><code>procs</code></strong></td>
<td><code>list</code></td>
<td><code>None</code></td>
<td>List of <a href="/tabular.core.html#TabularProc"><code>TabularProc</code></a>s passed to <a href="/tabular.data.html#TabularDataLoaders.from_df"><code>TabularDataLoaders.from_df</code></a></td>
</tr>
<tr>
<td><strong><code>cat_names</code></strong></td>
<td><code>list</code></td>
<td><code>None</code></td>
<td>Column names pertaining to categorical variables passed to <a href="/tabular.data.html#TabularDataLoaders.from_df"><code>TabularDataLoaders.from_df</code></a></td>
</tr>
<tr>
<td><strong><code>cont_names</code></strong></td>
<td><code>list</code></td>
<td><code>None</code></td>
<td>Column names pertaining to continuous variables passed to <a href="/tabular.data.html#TabularDataLoaders.from_df"><code>TabularDataLoaders.from_df</code></a></td>
</tr>
<tr>
<td><strong><code>y_names</code></strong></td>
<td><code>list</code></td>
<td><code>None</code></td>
<td>Names of the dependent variables passed to <a href="/tabular.data.html#TabularDataLoaders.from_df"><code>TabularDataLoaders.from_df</code></a></td>
</tr>
<tr>
<td><strong><code>y_block</code></strong></td>
<td><a href="/data.block.html#TransformBlock"><code>TransformBlock</code></a></td>
<td><code>None</code></td>
<td><a href="/data.block.html#TransformBlock"><code>TransformBlock</code></a> to use for the target(s) passed to <a href="/tabular.data.html#TabularDataLoaders.from_df"><code>TabularDataLoaders.from_df</code></a></td>
</tr>
<tr>
<td><strong><code>valid_idx</code></strong></td>
<td><code>list</code></td>
<td><code>None</code></td>
<td>List of indices to use for the validation set, defaults to a random split passed to <a href="/tabular.data.html#TabularDataLoaders.from_df"><code>TabularDataLoaders.from_df</code></a></td>
</tr>
<tr>
<td><strong><code>bs</code></strong></td>
<td><code>int</code></td>
<td><code>64</code></td>
<td>Argument passed to <a href="/tabular.data.html#TabularDataLoaders.from_df"><code>TabularDataLoaders.from_df</code></a></td>
</tr>
<tr>
<td><strong><code>shuffle_train</code></strong></td>
<td><code>bool</code></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.data.html#TabularDataLoaders.from_df"><code>TabularDataLoaders.from_df</code></a></td>
</tr>
<tr>
<td><strong><code>shuffle</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Argument passed to <a href="/tabular.data.html#TabularDataLoaders.from_df"><code>TabularDataLoaders.from_df</code></a></td>
</tr>
<tr>
<td><strong><code>val_shuffle</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Argument passed to <a href="/tabular.data.html#TabularDataLoaders.from_df"><code>TabularDataLoaders.from_df</code></a></td>
</tr>
<tr>
<td><strong><code>n</code></strong></td>
<td><code>int</code></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.data.html#TabularDataLoaders.from_df"><code>TabularDataLoaders.from_df</code></a></td>
</tr>
<tr>
<td><strong><code>device</code></strong></td>
<td><code>device</code></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.data.html#TabularDataLoaders.from_df"><code>TabularDataLoaders.from_df</code></a></td>
</tr>
<tr>
<td><strong><code>drop_last</code></strong></td>
<td><code>bool</code></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.data.html#TabularDataLoaders.from_df"><code>TabularDataLoaders.from_df</code></a></td>
</tr>
<tr>
<td><strong><code>val_bs</code></strong></td>
<td><code>int</code></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.data.html#TabularDataLoaders.from_df"><code>TabularDataLoaders.from_df</code></a></td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;workclass&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;marital-status&#39;</span><span class="p">,</span> <span class="s1">&#39;occupation&#39;</span><span class="p">,</span> <span class="s1">&#39;relationship&#39;</span><span class="p">,</span> <span class="s1">&#39;race&#39;</span><span class="p">]</span>
<span class="n">cont_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;fnlwgt&#39;</span><span class="p">,</span> <span class="s1">&#39;education-num&#39;</span><span class="p">]</span>
<span class="n">procs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Categorify</span><span class="p">,</span> <span class="n">FillMissing</span><span class="p">,</span> <span class="n">Normalize</span><span class="p">]</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">TabularDataLoaders</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;adult.csv&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">procs</span><span class="o">=</span><span class="n">procs</span><span class="p">,</span> <span class="n">cat_names</span><span class="o">=</span><span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="o">=</span><span class="n">cont_names</span><span class="p">,</span> 
                                  <span class="n">y_names</span><span class="o">=</span><span class="s2">&quot;salary&quot;</span><span class="p">,</span> <span class="n">valid_idx</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span><span class="mi">1000</span><span class="p">)),</span> <span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="TabularDataLoaders.test_dl" class="doc_header"><code>TabularDataLoaders.test_dl</code><a href="https://github.com/fastai/fastai/tree/master/fastai/tabular/data.py#L42" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>TabularDataLoaders.test_dl</code>(<strong><code>test_items</code></strong>, <strong><code>rm_type_tfms</code></strong>=<em><code>None</code></em>, <strong><code>process</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>inplace</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>bs</code></strong>=<em><code>16</code></em>, <strong><code>shuffle</code></strong>=<em><code>False</code></em>, <strong><code>after_batch</code></strong>=<em><code>None</code></em>, <strong><code>num_workers</code></strong>=<em><code>0</code></em>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>do_setup</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>pin_memory</code></strong>=<em><code>False</code></em>, <strong><code>timeout</code></strong>=<em><code>0</code></em>, <strong><code>batch_size</code></strong>=<em><code>None</code></em>, <strong><code>drop_last</code></strong>=<em><code>False</code></em>, <strong><code>indexed</code></strong>=<em><code>None</code></em>, <strong><code>n</code></strong>=<em><code>None</code></em>, <strong><code>device</code></strong>=<em><code>None</code></em>, <strong><code>persistent_workers</code></strong>=<em><code>False</code></em>, <strong><code>wif</code></strong>=<em><code>None</code></em>, <strong><code>before_iter</code></strong>=<em><code>None</code></em>, <strong><code>after_item</code></strong>=<em><code>None</code></em>, <strong><code>before_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_iter</code></strong>=<em><code>None</code></em>, <strong><code>create_batches</code></strong>=<em><code>None</code></em>, <strong><code>create_item</code></strong>=<em><code>None</code></em>, <strong><code>create_batch</code></strong>=<em><code>None</code></em>, <strong><code>retain</code></strong>=<em><code>None</code></em>, <strong><code>get_idxs</code></strong>=<em><code>None</code></em>, <strong><code>sample</code></strong>=<em><code>None</code></em>, <strong><code>shuffle_fn</code></strong>=<em><code>None</code></em>, <strong><code>do_batch</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create test <a href="/tabular.core.html#TabDataLoader"><code>TabDataLoader</code></a> from <code>test_items</code> using validation <code>procs</code></p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>test_items</code></strong></td>
<td></td>
<td></td>
<td>Items to create new test <a href="/tabular.core.html#TabDataLoader"><code>TabDataLoader</code></a> formatted the same as the training data</td>
</tr>
<tr>
<td><strong><code>rm_type_tfms</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Number of <a href="https://fastcore.fast.ai/transform#Transform"><code>Transform</code></a>s to be removed from <code>procs</code></td>
</tr>
<tr>
<td><strong><code>process</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Apply validation <a href="/tabular.core.html#TabularProc"><code>TabularProc</code></a>s to <code>test_items</code> immediately</td>
</tr>
<tr>
<td><strong><code>inplace</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Keep separate copy of original <code>test_items</code> in memory if <code>False</code></td>
</tr>
<tr>
<td></td>
<td></td>
<td><strong>Valid Keyword Arguments</strong></td>
<td></td>
</tr>
<tr>
<td><strong><code>bs</code></strong></td>
<td><code>int</code></td>
<td><code>16</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>shuffle</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>after_batch</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>num_workers</code></strong></td>
<td><code>int</code></td>
<td><code>0</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>verbose</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>do_setup</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>pin_memory</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>timeout</code></strong></td>
<td><code>int</code></td>
<td><code>0</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>batch_size</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>drop_last</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>indexed</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>n</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>device</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>persistent_workers</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>wif</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>before_iter</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>after_item</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>before_batch</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>after_iter</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>create_batches</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>create_item</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>create_batch</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>retain</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>get_idxs</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>sample</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>shuffle_fn</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
<tr>
<td><strong><code>do_batch</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Argument passed to <a href="/tabular.core.html#TabDataLoader.__init__"><code>TabDataLoader.__init__</code></a></td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>External structured data files can contain unexpected spaces, e.g. after a comma. We can see that in the first row of adult.csv <code>"49, Private,101320, ..."</code>. Often trimming is needed. Pandas has a convenient parameter <code>skipinitialspace</code> that is exposed by <a href="/tabular.data.html#TabularDataLoaders.from_csv("><code>TabularDataLoaders.from_csv()</code></a>). Otherwise category labels use for inference later such as <code>workclass</code>:<code>Private</code> will be categorized wrongly to <em>0</em> or <code>"#na#"</code> if training label was read as <code>" Private"</code>. Let's test this feature.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">49</span><span class="p">],</span> 
    <span class="s1">&#39;workclass&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Private&#39;</span><span class="p">],</span> 
    <span class="s1">&#39;fnlwgt&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">101320</span><span class="p">],</span>
    <span class="s1">&#39;education&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Assoc-acdm&#39;</span><span class="p">],</span> 
    <span class="s1">&#39;education-num&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">12.0</span><span class="p">],</span>
    <span class="s1">&#39;marital-status&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Married-civ-spouse&#39;</span><span class="p">],</span> 
    <span class="s1">&#39;occupation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">],</span>
    <span class="s1">&#39;relationship&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Wife&#39;</span><span class="p">],</span>
    <span class="s1">&#39;race&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;White&#39;</span><span class="p">],</span>
<span class="p">}</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="n">tdl</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">test_dl</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>

<span class="n">test_ne</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tdl</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;workclass&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

