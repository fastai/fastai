= fastai.dataloader
Jeremy Howard and contributors
:toc:

== Introduction and overview

*Note:* the fastai DataLoader has a similar API to the PyTorch DataLoader. As such, please see http://pytorch.org/docs/master/data.html#torch.utils.data.DataLoader[the PyTorch documentation] for usage and details. The documentation presented here focus on the differences between the two classes.

[[DataLoader]]
== Class DataLoader [.small]#(dataset, batch_size=1, shuffle=False, sampler=None, batch_sampler=None, pad_idx=0, num_workers=None, pin_memory=False, drop_last=False, pre_pad=True, half=False, transpose=False, transpose_y=False)#

=== Arguments

For information on arguments with no descriptions, please see http://pytorch.org/docs/master/data.html#torch.utils.data.DataLoader[the PyTorch documentation]

dataset::

batch_size::

shuffle::

sampler::

batch_sampler::

pad_idx (type int, default 0)::
    A padding index representing how many zeros to add to each batch. See: `pre_pad`

num_workers (type int, default `None`)::
    Allows the user to manually set the number of workers. If left as `None`, it will default to the number of CPU cores the system has. If > 0, the dataloader will create `num_workers` number of jobs using `concurrent.futures.ThreadPoolExecutor`.

pin_memory::

drop_last::

pre_pad (type bool, default `True`)::
    If `pad_idx` is non-zero, this determines if the zeros should go at the beginning of the batch, or at the end. By default, the zeros are added at the beginning of the batch.

half (type bool, default `False`)::
    If `True`, `torch.cuda.HalfTensor()` will be used instead of `torch.FloatTensor()`.

transpose (type bool, default `False`)::
    If `True`, each batch will have its inputs transposed.

transpose_y (type bool, default `False`)::
    If `True`, each batch will have its outputs (labels) transposed.


=== Methods

jag_stack::
Helper method for `np_collate()`. Returns a np.array of the batch passed in, with zeros added for any shorter rows inside the batch, plus extra zeros if `self.pad_idx > 0`.

np_collate::
Helper method for `get_batch()`. Based on the input data type, it creates an appropriate np.array, list, or dict. If the method is passed a string or list of strings, it simply returns the parameter without modification. Batches must contain numbers, strings, dicts, or lists, and this method ensures this is the case.

get_batch::
Helper method for `__iter__()`. When an iterator of the dataloader is created, `get_batch()` is used to retrieve items from the dataset and apply transposes based on `self.transpose` and `self.transpose_y`.
