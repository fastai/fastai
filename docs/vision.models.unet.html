---

title: vision.models.unet
keywords: fastai
sidebar: home_sidebar

summary: "Dynamic Unet that can use any pretrained model as a backbone."
---

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Dynamic-U-Net">Dynamic U-Net<a class="anchor-link" href="#Dynamic-U-Net">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This module builds a dynamic <a href="https://arxiv.org/abs/1505.04597">U-Net</a> from any backbone pretrained on ImageNet, automatically inferring the intermediate sizes.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="imgs/u-net-architecture.png" alt="U-Net architecure"></p>
<p>This is the original U-Net. The difference here is that the left part is a pretrained model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="DynamicUnet"><code>class</code> <code>DynamicUnet</code><a href="https://github.com/fastai/fastai/blob/master/fastai/vision/models/unet.py#L42" class="source_link">[source]</a></h2><blockquote><p><code>DynamicUnet</code>(<code>encoder</code>:<a href="https://pytorch.org/docs/stable/nn.html#torch.nn.Module"><code>Module</code></a>, <code>n_classes</code>:<code>int</code>) :: <a href="https://pytorch.org/docs/stable/nn.html#torch.nn.Sequential"><code>Sequential</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Builds a U-Net from a given <code>encoder</code> (that can be a pretrained model) and with a final output of <code>n_classes</code>. During the initialization, it uses <a href="/callbacks.hooks.html#Hooks"><code>Hooks</code></a> to determine the intermediate features sizes by passing a dummy input throught the model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="UnetBlock"><code>class</code> <code>UnetBlock</code><a href="https://github.com/fastai/fastai/blob/master/fastai/vision/models/unet.py#L14" class="source_link">[source]</a></h2><blockquote><p><code>UnetBlock</code>(<code>up_in_c</code>:<code>int</code>, <code>x_in_c</code>:<code>int</code>, <code>hook</code>:<a href="/callbacks.hooks.html#Hook"><code>Hook</code></a>) :: <a href="https://pytorch.org/docs/stable/nn.html#torch.nn.Module"><code>Module</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Builds a U-Net block that receives the output of the last block to be upsampled (size <code>up_in_c</code>) and the activations features from an intermediate layer of the <code>encoder</code> (size <code>x_in_c</code>, this is the lateral connection). The <code>hook</code> is set to this intermediate layer to store the output needed for this block.</p>

</div>
</div>
</div>
</div>
 

